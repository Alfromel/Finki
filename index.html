<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <meta name="mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <meta name="theme-color" content="#0a0a1a">
  <link rel="manifest" href="/manifest.json">
  <title>Finki TV Premium</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@300;400;500;700;900&family=Montserrat:wght@600;700;800&display=swap" rel="stylesheet">
  <link rel="icon" href="favicon.ico" type="image/x-icon">
  <link rel="icon" href="/favicon.ico" sizes="any">
  <link rel="icon" type="image/svg+xml" href="/favicon.svg">
  <link rel="icon" type="image/png" href="/favicon-96x96.png" sizes="96x96">
  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <meta name="apple-mobile-web-app-title" content="Finki TV">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="manifest" href="/site.webmanifest">
  <meta name="theme-color" content="#0a0a1a" media="(prefers-color-scheme: dark)">
  <meta name="theme-color" content="#ffffff" media="(prefers-color-scheme: light)">
  <style>
    :root {
      --primary-color: #0066ff;
      --primary-dark: #0052cc;
      --primary-light: #3385ff;
      --accent-color: #00ccff;
      --bg-dark: #000000;
      --bg-darker: #0a0a0a;
      --bg-card: #1a1a1a;
      --bg-card-hover: #222222;
      --text-light: #ffffff;
      --text-gray: #cccccc;
      --text-muted: #888888;
      --shadow: 0 4px 12px rgba(0, 102, 255, 0.3);
      --shadow-light: 0 2px 8px rgba(0, 102, 255, 0.2);
      --border-radius: 8px;
      --transition: all 0.3s ease;
    }

    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, var(--bg-darker) 0%, var(--bg-dark) 100%);
      color: var(--text-light);
      line-height: 1.6;
      overflow-x: hidden;
      -webkit-tap-highlight-color: transparent;
    }

    /* Snowflakes */
    .snowflakes {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      pointer-events: none;
      z-index: 100;
    }

    .snowflake {
      position: absolute;
      top: -10px;
      color: #fff;
      font-size: 1em;
      opacity: 0.7;
      animation: fall linear forwards;
    }

    @keyframes fall {
      to {
        transform: translateY(100vh);
      }
    }

    /* Splash Screen */
    .splash-screen {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      z-index: 9999;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .splash-video {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .splash-overlay {
      position: absolute;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: linear-gradient(
        to bottom,
        rgba(0, 0, 0, 0.7) 0%,
        rgba(0, 0, 0, 0.5) 50%,
        rgba(0, 0, 0, 0.7) 100%
      );
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    .splash-logo {
      font-family: 'Montserrat', sans-serif;
      font-weight: 800;
      font-size: 5rem;
      margin-bottom: 1rem;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-transform: uppercase;
      letter-spacing: 3px;
    }

    .splash-subtitle {
      font-family: 'Roboto', sans-serif;
      font-size: 1.2rem;
      color: var(--text-gray);
      letter-spacing: 2px;
      text-transform: uppercase;
    }

    .splash-progress {
      position: absolute;
      bottom: 50px;
      left: 50%;
      transform: translateX(-50%);
      width: 200px;
      height: 4px;
      background: rgba(255, 255, 255, 0.2);
      border-radius: 2px;
      overflow: hidden;
    }

    .splash-progress-bar {
      height: 100%;
      width: 0%;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      border-radius: 2px;
      transition: width 5s linear;
    }

    /* ========== DISEÑO MÓVIL ========== */
    .mobile-layout .app-container {
      min-height: 100vh;
      display: flex;
      flex-direction: column;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .mobile-layout .app-container.loaded {
      opacity: 1;
    }

    /* Header Styles */
    .mobile-layout .app-header {
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(0, 102, 255, 0.3);
      position: sticky;
      top: 0;
      z-index: 100;
    }

    .mobile-layout .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .mobile-layout .logo-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .mobile-layout .logo {
      width: 42px;
      height: 42px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 18px;
      box-shadow: var(--shadow);
    }

    .mobile-layout .logo-text {
      font-family: 'Montserrat', sans-serif;
      font-weight: 800;
      font-size: 26px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .mobile-layout .header-right {
      display: flex;
      align-items: center;
    }

    .mobile-layout .header-actions {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .mobile-layout .settings-btn {
      background: rgba(26, 26, 26, 0.8);
      border: none;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-gray);
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-light);
    }

    .mobile-layout .settings-btn:hover {
      color: var(--primary-color);
      background: rgba(0, 102, 255, 0.1);
      transform: rotate(90deg);
    }

    /* Main Content */
    .mobile-layout .main-content {
      flex: 1;
      padding: 20px;
    }

    .mobile-layout .content-section {
      display: none;
      animation: fadeIn 0.5s ease;
    }

    @keyframes fadeIn {
      from { opacity: 0; }
      to { opacity: 1; }
    }

    .mobile-layout .content-section.active {
      display: block;
    }

    .mobile-layout .section-title {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 24px;
      margin-bottom: 20px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
    }

    .mobile-layout .section-title::after {
      content: '';
      position: absolute;
      bottom: -8px;
      left: 0;
      width: 60px;
      height: 3px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }

    /* Channels Grid */
    .mobile-layout .channels-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .mobile-layout .channel-card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      box-shadow: var(--shadow-light);
      aspect-ratio: 16/9;
    }

    .mobile-layout .channel-card:hover, .mobile-layout .channel-card:active {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow);
      background: var(--bg-card-hover);
      border-color: rgba(0, 102, 255, 0.3);
      z-index: 10;
    }

    .mobile-layout .channel-thumbnail {
      position: relative;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .mobile-layout .channel-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .mobile-layout .channel-card:hover .channel-thumbnail img, 
    .mobile-layout .channel-card:active .channel-thumbnail img {
      transform: scale(1.05);
    }

    .mobile-layout .channel-live-badge {
      position: absolute;
      top: 8px;
      right: 8px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      color: white;
      font-size: 10px;
      padding: 3px 8px;
      border-radius: 10px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: var(--shadow-light);
    }

    .mobile-layout .channel-number {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      width: 24px;
      height: 24px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 12px;
    }

    .mobile-layout .channel-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      font-weight: 500;
      text-align: center;
      font-size: 14px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
    }

    /* Series Grid */
    .mobile-layout .series-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .mobile-layout .series-card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      box-shadow: var(--shadow-light);
      aspect-ratio: 2/3;
    }

    .mobile-layout .series-card:hover, .mobile-layout .series-card:active {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow);
      background: var(--bg-card-hover);
      border-color: rgba(0, 102, 255, 0.3);
      z-index: 10;
    }

    .mobile-layout .series-thumbnail {
      position: relative;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .mobile-layout .series-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .mobile-layout .series-card:hover .series-thumbnail img, 
    .mobile-layout .series-card:active .series-thumbnail img {
      transform: scale(1.05);
    }

    .mobile-layout .series-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      font-weight: 500;
      text-align: center;
      font-size: 14px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
    }

    /* Movies Grid */
    .mobile-layout .movies-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(160px, 1fr));
      gap: 15px;
      max-width: 1200px;
      margin: 0 auto;
    }

    .mobile-layout .movie-card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      box-shadow: var(--shadow-light);
      aspect-ratio: 2/3;
    }

    .mobile-layout .movie-card:hover, .mobile-layout .movie-card:active {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow);
      background: var(--bg-card-hover);
      border-color: rgba(0, 102, 255, 0.3);
      z-index: 10;
    }

    .mobile-layout .movie-thumbnail {
      position: relative;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .mobile-layout .movie-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .mobile-layout .movie-card:hover .movie-thumbnail img, 
    .mobile-layout .movie-card:active .movie-thumbnail img {
      transform: scale(1.05);
    }

    .mobile-layout .movie-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      font-weight: 500;
      text-align: center;
      font-size: 14px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
    }

    /* Coming Soon Sections */
    .mobile-layout .coming-full-container {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 60vh;
    }

    .mobile-layout .coming-full-content {
      text-align: center;
      max-width: 500px;
      padding: 40px;
      background: var(--bg-card);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    .mobile-layout .coming-full-content i {
      font-size: 80px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 20px;
    }

    .mobile-layout .coming-full-content h2 {
      font-size: 28px;
      margin-bottom: 15px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .mobile-layout .coming-full-content p {
      color: var(--text-gray);
      margin-bottom: 20px;
    }

    .mobile-layout .coming-badge {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      color: white;
      padding: 8px 20px;
      border-radius: 20px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      box-shadow: var(--shadow-light);
    }

    /* Footer */
    .mobile-layout .app-footer {
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(10px);
      border-top: 1px solid rgba(0, 102, 255, 0.3);
      padding: 15px 0;
      margin-top: auto;
      position: sticky;
      bottom: 0;
      z-index: 100;
    }

    .mobile-layout .footer-nav {
      display: flex;
      justify-content: center;
      gap: 40px;
    }

    .mobile-layout .footer-nav-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 5px;
      background: none;
      border: none;
      color: var(--text-gray);
      cursor: pointer;
      padding: 10px 15px;
      border-radius: 10px;
      transition: var(--transition);
      min-width: 70px;
    }

    .mobile-layout .footer-nav-btn i {
      font-size: 20px;
      transition: var(--transition);
    }

    .mobile-layout .footer-nav-btn span {
      font-size: 12px;
      font-weight: 500;
      transition: var(--transition);
    }

    .mobile-layout .footer-nav-btn.active {
      color: var(--primary-color);
      background: rgba(0, 102, 255, 0.1);
    }

    .mobile-layout .footer-nav-btn.active i {
      transform: translateY(-2px);
    }

    .mobile-layout .footer-nav-btn:hover, .mobile-layout .footer-nav-btn:active {
      background: rgba(0, 102, 255, 0.1);
      color: var(--primary-color);
    }

    /* ========== DISEÑO TV ========== */
    .tv-layout {
      width: 100vw;
      height: 100vh;
      overflow: hidden;
    }

    .tv-layout .app-container {
      width: 100%;
      height: 100%;
      display: flex;
      opacity: 0;
      transition: opacity 0.5s ease;
    }

    .tv-layout .app-container.loaded {
      opacity: 1;
    }

    /* Sidebar Navigation */
    .tv-layout .sidebar-nav {
      width: 120px;
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(10px);
      border-right: 1px solid rgba(0, 102, 255, 0.3);
      display: flex;
      flex-direction: column;
      padding: 20px 0;
      z-index: 100;
    }

    .tv-layout .nav-btn {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 8px;
      background: none;
      border: none;
      color: var(--text-gray);
      cursor: pointer;
      padding: 20px 10px;
      transition: var(--transition);
      width: 100%;
    }

    .tv-layout .nav-btn i {
      font-size: 24px;
      transition: var(--transition);
    }

    .tv-layout .nav-btn span {
      font-size: 14px;
      font-weight: 500;
      transition: var(--transition);
    }

    .tv-layout .nav-btn.active, .tv-layout .nav-btn.focused {
      color: var(--primary-color);
      background: rgba(0, 102, 255, 0.1);
    }

    .tv-layout .nav-btn.active i, .tv-layout .nav-btn.focused i {
      transform: translateY(-2px);
    }

    .tv-layout .nav-btn:hover {
      background: rgba(0, 102, 255, 0.1);
      color: var(--primary-color);
    }

    /* Main Content Area */
    .tv-layout .main-content-area {
      flex: 1;
      display: flex;
      flex-direction: column;
      height: 100%;
    }

    /* Header Styles */
    .tv-layout .app-header {
      background: rgba(10, 10, 10, 0.95);
      backdrop-filter: blur(10px);
      padding: 15px 30px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      border-bottom: 1px solid rgba(0, 102, 255, 0.3);
      z-index: 100;
    }

    .tv-layout .header-left {
      display: flex;
      align-items: center;
      gap: 20px;
    }

    .tv-layout .logo-container {
      display: flex;
      align-items: center;
      gap: 12px;
    }

    .tv-layout .logo {
      width: 42px;
      height: 42px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      border-radius: 10px;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: bold;
      font-size: 18px;
      box-shadow: var(--shadow);
    }

    .tv-layout .logo-text {
      font-family: 'Montserrat', sans-serif;
      font-weight: 800;
      font-size: 26px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-transform: uppercase;
      letter-spacing: 1px;
    }

    .tv-layout .header-right {
      display: flex;
      align-items: center;
    }

    .tv-layout .header-actions {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .tv-layout .settings-btn {
      background: rgba(26, 26, 26, 0.8);
      border: none;
      width: 44px;
      height: 44px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      color: var(--text-gray);
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-light);
    }

    .tv-layout .settings-btn:hover, .tv-layout .settings-btn.focused {
      color: var(--primary-color);
      background: rgba(0, 102, 255, 0.1);
      transform: rotate(90deg);
    }

    /* Main Content */
    .tv-layout .main-content {
      flex: 1;
      padding: 30px;
      overflow-y: auto;
      height: calc(100% - 80px);
    }

    .tv-layout .content-section {
      display: none;
      animation: fadeIn 0.5s ease;
      height: 100%;
    }

    .tv-layout .content-section.active {
      display: block;
    }

    .tv-layout .section-title {
      font-family: 'Montserrat', sans-serif;
      font-weight: 700;
      font-size: 32px;
      margin-bottom: 30px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      text-transform: uppercase;
      letter-spacing: 1px;
      position: relative;
    }

    .tv-layout .section-title::after {
      content: '';
      position: absolute;
      bottom: -12px;
      left: 0;
      width: 80px;
      height: 4px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      border-radius: 2px;
    }

    /* Channels Grid */
    .tv-layout .channels-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .tv-layout .channel-card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      box-shadow: var(--shadow-light);
      aspect-ratio: 16/9;
    }

    .tv-layout .channel-card:hover, .tv-layout .channel-card.focused {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow);
      background: var(--bg-card-hover);
      border-color: rgba(0, 102, 255, 0.3);
      z-index: 10;
    }

    .tv-layout .channel-thumbnail {
      position: relative;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .tv-layout .channel-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .tv-layout .channel-card:hover .channel-thumbnail img, 
    .tv-layout .channel-card.focused .channel-thumbnail img {
      transform: scale(1.05);
    }

    .tv-layout .channel-live-badge {
      position: absolute;
      top: 10px;
      right: 10px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      color: white;
      font-size: 12px;
      padding: 4px 10px;
      border-radius: 10px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      box-shadow: var(--shadow-light);
    }

    .tv-layout .channel-number {
      position: absolute;
      top: 10px;
      left: 10px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 14px;
    }

    .tv-layout .channel-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 12px;
      font-weight: 500;
      text-align: center;
      font-size: 16px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
    }

    /* Series Grid */
    .tv-layout .series-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .tv-layout .series-card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      box-shadow: var(--shadow-light);
      aspect-ratio: 2/3;
    }

    .tv-layout .series-card:hover, .tv-layout .series-card.focused {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow);
      background: var(--bg-card-hover);
      border-color: rgba(0, 102, 255, 0.3);
      z-index: 10;
    }

    .tv-layout .series-thumbnail {
      position: relative;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .tv-layout .series-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .tv-layout .series-card:hover .series-thumbnail img, 
    .tv-layout .series-card.focused .series-thumbnail img {
      transform: scale(1.05);
    }

    .tv-layout .series-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 12px;
      font-weight: 500;
      text-align: center;
      font-size: 16px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
    }

    /* Movies Grid */
    .tv-layout .movies-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 20px;
      max-width: 1400px;
      margin: 0 auto;
    }

    .tv-layout .movie-card {
      background: var(--bg-card);
      border-radius: var(--border-radius);
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      position: relative;
      box-shadow: var(--shadow-light);
      aspect-ratio: 2/3;
    }

    .tv-layout .movie-card:hover, .tv-layout .movie-card.focused {
      transform: translateY(-5px) scale(1.05);
      box-shadow: var(--shadow);
      background: var(--bg-card-hover);
      border-color: rgba(0, 102, 255, 0.3);
      z-index: 10;
    }

    .tv-layout .movie-thumbnail {
      position: relative;
      height: 100%;
      background: #000;
      display: flex;
      align-items: center;
      justify-content: center;
      overflow: hidden;
    }

    .tv-layout .movie-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }

    .tv-layout .movie-card:hover .movie-thumbnail img, 
    .tv-layout .movie-card.focused .movie-thumbnail img {
      transform: scale(1.05);
    }

    .tv-layout .movie-title {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 12px;
      font-weight: 500;
      text-align: center;
      font-size: 16px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
      color: white;
    }

    /* Coming Soon Sections */
    .tv-layout .coming-full-container {
      display: flex;
      align-items: center;
      justify-content: center;
      height: 100%;
    }

    .tv-layout .coming-full-content {
      text-align: center;
      max-width: 600px;
      padding: 50px;
      background: var(--bg-card);
      border-radius: var(--border-radius);
      box-shadow: var(--shadow);
    }

    .tv-layout .coming-full-content i {
      font-size: 100px;
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 30px;
    }

    .tv-layout .coming-full-content h2 {
      font-size: 36px;
      margin-bottom: 20px;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .tv-layout .coming-full-content p {
      color: var(--text-gray);
      margin-bottom: 30px;
      font-size: 18px;
    }

    .tv-layout .coming-badge {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      color: white;
      padding: 10px 25px;
      border-radius: 20px;
      font-weight: bold;
      text-transform: uppercase;
      letter-spacing: 1px;
      font-size: 16px;
      box-shadow: var(--shadow-light);
    }

    /* Focus styles for TV navigation */
    .tv-layout .channel-card:focus,
    .tv-layout .series-card:focus,
    .tv-layout .movie-card:focus,
    .tv-layout .nav-btn:focus,
    .tv-layout .episode-card:focus {
      outline: 2px solid var(--primary-color);
      outline-offset: 2px;
    }

    /* Selection indicator for TV remote navigation */
    .tv-layout .selection-indicator {
      position: absolute;
      top: -5px;
      left: -5px;
      right: -5px;
      bottom: -5px;
      border: 2px solid var(--primary-color);
      border-radius: var(--border-radius);
      z-index: 5;
      pointer-events: none;
      opacity: 0;
      transition: opacity 0.2s ease;
    }

    .tv-layout .channel-card.focused .selection-indicator,
    .tv-layout .series-card.focused .selection-indicator,
    .tv-layout .movie-card.focused .selection-indicator,
    .tv-layout .nav-btn.focused .selection-indicator,
    .tv-layout .episode-card.focused .selection-indicator {
      opacity: 1;
    }

    /* ========== ELEMENTOS COMPARTIDOS ========== */
    /* Fullscreen Player */
    .fullscreen-player {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      z-index: 2000;
      display: none;
    }

    .fullscreen-player.active {
      display: block;
    }

    .fullscreen-player iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Series Fullscreen Player */
    .series-fullscreen-player {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      z-index: 2000;
      display: none;
    }

    .series-fullscreen-player.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .series-fullscreen-player iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Movies Fullscreen Player */
    .movies-fullscreen-player {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: #000;
      z-index: 2000;
      display: none;
    }

    .movies-fullscreen-player.active {
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .movies-fullscreen-player iframe {
      width: 100%;
      height: 100%;
      border: none;
    }

    /* Modal */
    .tv-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1000;
      align-items: center;
      justify-content: center;
    }

    .tv-modal.active {
      display: flex;
    }

    .modal-content {
      background: var(--bg-card);
      border-radius: 15px;
      width: 90%;
      max-width: 400px;
      padding: 30px;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0, 102, 255, 0.3);
      text-align: center;
    }

    .modal-content h2 {
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      margin-bottom: 25px;
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 10px;
    }

    .modal-actions {
      margin-top: 25px;
    }

    .btn-primary {
      background: linear-gradient(135deg, var(--primary-color) 0%, var(--accent-color) 100%);
      color: white;
      border: none;
      border-radius: 8px;
      padding: 12px 30px;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-light);
    }

    .btn-primary:hover, .btn-primary.focused {
      transform: translateY(-2px);
      box-shadow: var(--shadow);
    }

    /* TV Controls Overlay */
    .tv-controls-overlay {
      position: fixed;
      bottom: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.7);
      color: white;
      padding: 10px 20px;
      border-radius: 10px;
      font-size: 14px;
      z-index: 9999;
      text-align: center;
      transition: opacity 0.3s ease;
      backdrop-filter: blur(5px);
    }

    .current-channel {
      font-size: 16px;
      font-weight: bold;
      margin-bottom: 5px;
      color: var(--primary-color);
    }

    .tv-instructions {
      font-size: 12px;
      opacity: 0.8;
    }

    /* Channel Change Notification */
    .channel-change-notification {
      position: fixed;
      top: 20px;
      left: 50%;
      transform: translateX(-50%);
      background: rgba(0, 0, 0, 0.8);
      color: white;
      padding: 15px 25px;
      border-radius: 10px;
      font-size: 18px;
      z-index: 10000;
      transition: opacity 0.3s ease;
      display: flex;
      align-items: center;
      gap: 15px;
      backdrop-filter: blur(5px);
    }

    .notification-content {
      display: flex;
      align-items: center;
      gap: 15px;
    }

    .channel-number {
      background: var(--primary-color);
      color: white;
      width: 30px;
      height: 30px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
    }

    /* Series Selection Modal */
    .series-selection-modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.9);
      z-index: 1500;
      align-items: center;
      justify-content: center;
    }

    .series-selection-modal.active {
      display: flex;
    }

    .series-modal-content {
      background: var(--bg-card);
      border-radius: 15px;
      width: 90%;
      max-width: 800px;
      max-height: 80vh;
      overflow-y: auto;
      box-shadow: var(--shadow);
      border: 1px solid rgba(0, 102, 255, 0.3);
    }

    .series-modal-header {
      padding: 20px 25px;
      border-bottom: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .series-modal-title {
      font-size: 22px;
      font-weight: 700;
      background: linear-gradient(to right, var(--primary-color), var(--accent-color));
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
    }

    .close-modal {
      background: none;
      border: none;
      color: var(--text-gray);
      font-size: 20px;
      cursor: pointer;
      transition: var(--transition);
    }

    .close-modal:hover, .close-modal.focused {
      color: var(--primary-color);
    }

    .series-modal-body {
      padding: 25px;
    }

    .episodes-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(150px, 1fr));
      gap: 15px;
    }

    .episode-card {
      background: var(--bg-darker);
      border-radius: 10px;
      overflow: hidden;
      cursor: pointer;
      transition: var(--transition);
      border: 1px solid rgba(255, 255, 255, 0.05);
      aspect-ratio: 16/9;
      position: relative;
    }

    .episode-card:hover, .episode-card.focused {
      transform: translateY(-5px);
      box-shadow: var(--shadow-light);
      border-color: rgba(0, 102, 255, 0.3);
    }

    .episode-thumbnail {
      position: relative;
      height: 100%;
      overflow: hidden;
    }

    .episode-thumbnail img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }

    .episode-info {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 10px;
      background: linear-gradient(to top, rgba(0,0,0,0.8), transparent);
    }

    .episode-title {
      font-weight: 600;
      margin-bottom: 5px;
      font-size: 14px;
      color: white;
    }

    .episode-duration {
      color: var(--text-muted);
      font-size: 12px;
    }

    /* Episodio número badge - NUEVO ESTILO AÑADIDO */
    .episode-number-badge {
      position: absolute;
      top: 8px;
      left: 8px;
      background: rgba(0, 0, 0, 0.7);
      color: white;
      width: 28px;
      height: 28px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: bold;
      font-size: 12px;
      z-index: 2;
    }

    /* Responsive */
    @media (max-width: 768px) {
      .mobile-layout .app-header {
        padding: 15px;
      }
      
      .mobile-layout .logo-text {
        font-size: 22px;
      }
      
      .mobile-layout .channels-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
      }
      
      .mobile-layout .series-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
      }
      
      .mobile-layout .movies-grid {
        grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
        gap: 12px;
      }
      
      .mobile-layout .footer-nav {
        gap: 20px;
      }
      
      .mobile-layout .main-content {
        padding: 15px;
      }
      
      .mobile-layout .section-title {
        font-size: 20px;
      }

      .series-fullscreen-player iframe {
        width: 100%;
        height: 100%;
      }

      .movies-fullscreen-player iframe {
        width: 100%;
        height: 100%;
      }

      .splash-logo {
        font-size: 3.5rem;
      }

      .splash-subtitle {
        font-size: 1rem;
      }

      .episodes-grid {
        grid-template-columns: repeat(auto-fill, minmax(130px, 1fr));
      }

      .episode-number-badge {
        width: 24px;
        height: 24px;
        font-size: 11px;
      }
    }

    @media (max-width: 480px) {
      .mobile-layout .channels-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
      }
      
      .mobile-layout .series-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
      }
      
      .mobile-layout .movies-grid {
        grid-template-columns: repeat(auto-fill, minmax(120px, 1fr));
        gap: 10px;
      }
      
      .mobile-layout .footer-nav {
        gap: 10px;
      }
      
      .mobile-layout .footer-nav-btn {
        padding: 8px 10px;
        min-width: 60px;
      }
      
      .mobile-layout .footer-nav-btn span {
        font-size: 10px;
      }
      
      .mobile-layout .main-content {
        padding: 10px;
      }

      .splash-logo {
        font-size: 2.5rem;
      }

      .splash-subtitle {
        font-size: 0.9rem;
      }

      .episodes-grid {
        grid-template-columns: repeat(auto-fill, minmax(110px, 1fr));
      }

      .episode-number-badge {
        width: 22px;
        height: 22px;
        font-size: 10px;
      }
    }

    /* TV Box specific styles */
    @media (min-width: 1024px) and (min-height: 600px) {
      .tv-layout .channel-card,
      .tv-layout .series-card,
      .tv-layout .movie-card {
        min-height: auto;
      }
      
      .tv-layout .channel-thumbnail,
      .tv-layout .series-thumbnail,
      .tv-layout .movie-thumbnail {
        height: 100%;
      }
      
      .tv-layout .nav-btn {
        padding: 20px 10px;
      }
      
      .tv-layout .nav-btn i {
        font-size: 24px;
      }
      
      .tv-layout .nav-btn span {
        font-size: 14px;
      }
    }

    /* Back button handling */
    .back-button-handler {
      display: none;
    }
  </style>
</head>
<body>
    <!-- Snowflakes Container -->
    <div class="snowflakes" id="snowflakes"></div>

    <!-- Splash Screen -->
    <div class="splash-screen" id="splash-screen">
      <video class="splash-video" autoplay muted loop>
        <!-- Reemplaza esta URL con tu video de fondo -->
        <source src="video/inicio.mp4" type="video/mp4">
      </video>
      <div class="splash-overlay">
        <div class="splash-logo">GC</div>
        <div class="splash-subtitle">MPC</div>
        <div class="splash-progress">
          <div class="splash-progress-bar" id="splash-progress"></div>
        </div>
      </div>
    </div>

    <!-- Diseño Móvil -->
    <div class="mobile-layout" id="mobile-layout" style="display: none;">
        <!-- App Container -->
        <div class="app-container" id="app-container">
            <!-- App Header -->
            <header class="app-header">
                <div class="header-left">
                    <div class="logo-container">
                        <div class="logo">GC</div>
                        <span class="logo-text">Finki</span>
                    </div>
                </div>
                <div class="header-right">
                    <div class="header-actions">
                        <button class="settings-btn" id="settings-btn">
                            <i class="fas fa-cog"></i>
                        </button>
                    </div>
                </div>
            </header>

            <!-- Main Content -->
            <main class="main-content">
                <!-- Home Section -->
                <section class="content-section active" id="home-section">
                    <div class="channels-container">
                        <h2 class="section-title">Canales en Vivo</h2>
                        <div class="channels-grid" id="channels-grid">
                            <!-- Channels will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Channels Section -->
                <section class="content-section" id="channels-section">
                    <div class="channels-container">
                        <h2 class="section-title">Todos los Canales</h2>
                        <div class="channels-grid" id="all-channels-grid">
                            <!-- All channels will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Movies Section -->
                <section class="content-section" id="movies-section">
                    <div class="movies-container">
                        <h2 class="section-title">Nuestras Películas</h2>
                        <div class="movies-grid" id="movies-grid">
                            <!-- Movies will be loaded here -->
                        </div>
                    </div>
                </section>

                <!-- Series Section -->
                <section class="content-section" id="series-section">
                    <div class="series-container">
                        <h2 class="section-title">Nuestras Series</h2>
                        <div class="series-grid" id="series-grid">
                            <!-- Series will be loaded here -->
                        </div>
                    </div>
                </section>
            </main>

            <!-- Quick Navigation Footer -->
            <footer class="app-footer">
                <div class="footer-nav">
                    <button class="footer-nav-btn active" data-section="home">
                        <i class="fas fa-home"></i>
                        <span>Inicio</span>
                    </button>
                    <button class="footer-nav-btn" data-section="channels">
                        <i class="fas fa-tv"></i>
                        <span>Canales</span>
                    </button>
                    <button class="footer-nav-btn" data-section="movies">
                        <i class="fas fa-film"></i>
                        <span>Películas</span>
                    </button>
                    <button class="footer-nav-btn" data-section="series">
                        <i class="fas fa-tv"></i>
                        <span>Series</span>
                    </button>
                </div>
            </footer>
        </div>
    </div>

    <!-- Diseño TV -->
    <div class="tv-layout" id="tv-layout" style="display: none;">
        <!-- App Container -->
        <div class="app-container" id="tv-app-container">
            <!-- Sidebar Navigation -->
            <nav class="sidebar-nav">
                <button class="nav-btn active" data-section="home">
                    <i class="fas fa-home"></i>
                    <span>Inicio</span>
                    <div class="selection-indicator"></div>
                </button>
                <button class="nav-btn" data-section="channels">
                    <i class="fas fa-tv"></i>
                    <span>Canales</span>
                    <div class="selection-indicator"></div>
                </button>
                <button class="nav-btn" data-section="movies">
                    <i class="fas fa-film"></i>
                    <span>Películas</span>
                    <div class="selection-indicator"></div>
                </button>
                <button class="nav-btn" data-section="series">
                    <i class="fas fa-tv"></i>
                    <span>Series</span>
                    <div class="selection-indicator"></div>
                </button>
            </nav>

            <!-- Main Content Area -->
            <div class="main-content-area">
                <!-- App Header -->
                <header class="app-header">
                    <div class="header-left">
                        <div class="logo-container">
                            <div class="logo">GC</div>
                            <span class="logo-text">Finki</span>
                        </div>
                    </div>
                    <div class="header-right">
                        <div class="header-actions">
                            <button class="settings-btn" id="tv-settings-btn">
                                <i class="fas fa-cog"></i>
                                <div class="selection-indicator"></div>
                            </button>
                        </div>
                    </div>
                </header>

                <!-- Main Content -->
                <main class="main-content">
                    <!-- Home Section -->
                    <section class="content-section active" id="tv-home-section">
                        <div class="channels-container">
                            <h2 class="section-title">Canales en Vivo</h2>
                            <div class="channels-grid" id="tv-channels-grid">
                                <!-- Channels will be loaded here -->
                            </div>
                        </div>
                    </section>

                    <!-- Channels Section -->
                    <section class="content-section" id="tv-channels-section">
                        <div class="channels-container">
                            <h2 class="section-title">Todos los Canales</h2>
                            <div class="channels-grid" id="tv-all-channels-grid">
                                <!-- All channels will be loaded here -->
                            </div>
                        </div>
                    </section>

                    <!-- Movies Section -->
                    <section class="content-section" id="tv-movies-section">
                        <div class="movies-container">
                            <h2 class="section-title">Nuestras Películas</h2>
                            <div class="movies-grid" id="tv-movies-grid">
                                <!-- Movies will be loaded here -->
                            </div>
                        </div>
                    </section>

                    <!-- Series Section -->
                    <section class="content-section" id="tv-series-section">
                        <div class="series-container">
                            <h2 class="section-title">Nuestras Series</h2>
                            <div class="series-grid" id="tv-series-grid">
                                <!-- Series will be loaded here -->
                            </div>
                        </div>
                    </section>
                </main>
            </div>
        </div>
    </div>

    <!-- Fullscreen Player for Channels -->
    <div class="fullscreen-player" id="fullscreen-player">
        <div id="fullscreen-iframe-container"></div>
    </div>

    <!-- Fullscreen Player for Series -->
    <div class="series-fullscreen-player" id="series-fullscreen-player">
        <iframe id="series-iframe" allowfullscreen allow="autoplay"></iframe>
    </div>

    <!-- Fullscreen Player for Movies -->
    <div class="movies-fullscreen-player" id="movies-fullscreen-player">
        <iframe id="movies-iframe" allowfullscreen allow="autoplay"></iframe>
    </div>

    <!-- Series Selection Modal -->
    <div class="series-selection-modal" id="series-selection-modal">
        <div class="series-modal-content">
            <div class="series-modal-header">
                <h2 class="series-modal-title" id="series-modal-title">Seleccionar Episodio</h2>
                <button class="close-modal" id="close-series-modal">
                    <i class="fas fa-times"></i>
                    <div class="selection-indicator"></div>
                </button>
            </div>
            <div class="series-modal-body">
                <div class="episodes-grid" id="episodes-grid">
                    <!-- Episodes will be loaded here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="tv-modal" id="settings-modal">
        <div class="modal-content">
            <h2><i class="fas fa-cog"></i> AJUSTES</h2>
            <div class="modal-actions">
                <button class="btn-primary" id="close-settings">Cerrar</button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Detectar tipo de dispositivo por relación de aspecto
            function detectDeviceType() {
                const width = window.innerWidth;
                const height = window.innerHeight;
                
                // Si el ancho es mayor que el alto = TV (pantalla horizontal)
                // Si el alto es mayor que el ancho = Móvil (pantalla vertical)
                const isTV = width > height;
                
                return isTV ? 'tv' : 'mobile';
            }

            // Inicializar diseño según el tipo de dispositivo
            function initializeLayout() {
                const deviceType = detectDeviceType();
                
                if (deviceType === 'tv') {
                    document.getElementById('tv-layout').style.display = 'block';
                    document.getElementById('mobile-layout').style.display = 'none';
                    initializeTVApp();
                } else {
                    document.getElementById('tv-layout').style.display = 'none';
                    document.getElementById('mobile-layout').style.display = 'block';
                    initializeMobileApp();
                }
                
                // Activar función de mantener pantalla encendida
                activateScreenWakeLock();
            }

            // Función para mantener la pantalla encendida
            function activateScreenWakeLock() {
                if ('wakeLock' in navigator) {
                    let wakeLock = null;
                    
                    const requestWakeLock = async () => {
                        try {
                            wakeLock = await navigator.wakeLock.request('screen');
                            console.log('Pantalla siempre encendida activada');
                            
                            wakeLock.addEventListener('release', () => {
                                console.log('Pantalla siempre encendida desactivada');
                            });
                        } catch (err) {
                            console.error('Error al activar pantalla siempre encendida:', err);
                        }
                    };
                    
                    requestWakeLock();
                    
                    // Reactivar cuando la página vuelva a ser visible
                    document.addEventListener('visibilitychange', () => {
                        if (document.visibilityState === 'visible' && wakeLock === null) {
                            requestWakeLock();
                        }
                    });
                } else {
                    console.log('API Wake Lock no soportada');
                }
            }

            // Create snowflakes
            function createSnowflakes() {
                const snowflakesContainer = document.getElementById('snowflakes');
                const snowflakeCount = 30; // Reduced number of snowflakes
                
                for (let i = 0; i < snowflakeCount; i++) {
                    const snowflake = document.createElement('div');
                    snowflake.className = 'snowflake';
                    snowflake.innerHTML = '❄';
                    
                    // Random position
                    const left = Math.random() * 100;
                    snowflake.style.left = `${left}vw`;
                    
                    // Random size
                    const size = Math.random() * 0.8 + 0.5;
                    snowflake.style.fontSize = `${size}em`;
                    
                    // Random animation duration
                    const duration = Math.random() * 10 + 10;
                    snowflake.style.animationDuration = `${duration}s`;
                    
                    // Random delay
                    const delay = Math.random() * 5;
                    snowflake.style.animationDelay = `${delay}s`;
                    
                    snowflakesContainer.appendChild(snowflake);
                }
            }

            // Remove snowflakes when in fullscreen
            function removeSnowflakes() {
                const snowflakesContainer = document.getElementById('snowflakes');
                snowflakesContainer.innerHTML = '';
            }

            // Restore snowflakes when exiting fullscreen
            function restoreSnowflakes() {
                createSnowflakes();
            }

            // Splash Screen Elements
            const splashScreen = document.getElementById('splash-screen');
            const splashProgress = document.getElementById('splash-progress');
            const appContainer = document.getElementById('app-container');
            const tvAppContainer = document.getElementById('tv-app-container');

            // Show splash screen and start progress
            splashProgress.style.width = '100%';
            
            setTimeout(function() {
                splashScreen.style.opacity = '0';
                setTimeout(function() {
                    splashScreen.style.display = 'none';
                    initializeLayout();
                }, 500);
            }, 5000); // 5 seconds

            // Channel data
            const channels = [
                {
                    id: 1,
                    title: "BOLIVIA TV",
                    thumbnail: "https://www.boliviatv.bo/principal/images/icons/logos/logo_defecto.jpg",
                    iframeCode: `<div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;"><iframe src="https://geo.dailymotion.com/player.html?video=x9nzqpo" style="width:100%; height:100%; position:absolute; left:0px; top:0px; overflow:hidden; border:none;" allowfullscreen title="Dailymotion Video Player" allow="web-share"></iframe></div>`
                },
                {
                    id: 2,
                    title: "RED UNO",
                    thumbnail: "https://yt3.googleusercontent.com/Z9-5VuT1xqHWp_QJ3JvLD-PZlYQt_subNOfi-Lz-qYN75iaFP2r0oK7qclcnP4o9biLIo6qQROA=s900-c-k-c0x00ffffff-no-rj",
                    iframeCode: `<div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;">
                        <iframe src="https://geo.dailymotion.com/player.html?video=x9n2qyk"
                            style="width:100%; height:100%; position:absolute; left:0px; top:0px; overflow:hidden; border:none;"
                            allowfullscreen
                            title="Dailymotion Video Player"
                            allow="web-share">
                        </iframe>
                    </div>`
                },
                {
                    id: 3,
                    title: "BOLIVIA VS PERUL",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSOdEfaOkHFy6LeOzD_hgc1vDvrwDf0OPf45g&s",
                    iframeCode: `<div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;">
                        <iframe src="https://geo.dailymotion.com/player.html?video=x9n2qyk"
                            style="width:100%; height:100%; position:absolute; left:0px; top:0px; overflow:hidden; border:none;"
                            allowfullscreen
                            title="Dailymotion Video Player"
                            allow="web-share">
                        </iframe>
                },
                {
                    id: 4,
                    title: "ATB",
                    thumbnail: "https://play-lh.googleusercontent.com/sgL9elaLnROZ-njx1G5n7PyIcYWvaUuIsjecWtTOAY275giwquEG_J07ETmJbxfBFNaX",
                    iframeCode: `<div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;">
                        <iframe src="https://geo.dailymotion.com/player.html?video=x84eirw"
                            style="width:100%; height:100%; position:absolute; left:0px; top:0px; overflow:hidden; border:none;"
                            allowfullscreen
                            title="Dailymotion Video Player"
                            allow="web-share">
                        </iframe>
                    </div>`
                },
                {
                    id: 5,
                    title: "BOLIVISION",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTz_l8SYGwAy5V9Bzc2ZloQdwjhNHW-zV3cqg&s",
                    iframeCode: `<div style="position:relative;padding-bottom:56.25%;height:0;overflow:hidden;">
                        <video width="100%" height="100%" controls autoplay style="position:absolute; left:0px; top:0px;">
                            <source src="https://d2qsan2ut81n2k.cloudfront.net/live/20446f64-67d8-4100-8c4b-20a759a8e919/ts:abr.m3u8" type="application/x-mpegURL">
                            Tu navegador no soporta el elemento de video.
                        </video>
                    </div>`
                }
            ];

            // Series data
            const series = [
                {
                    id: 1,
                    title: "HÉROES DE GUARDIA",
                    thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                    episodes: [
                        {
                            id: 1,
                            title: "Episodio 1",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445488266?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 2,
                            title: "Episodio 2",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445553802?autoplay=1",
                            duration: "42 min"
                        },
                        {
                            id: 3,
                            title: "Episodio 3",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445619338?autoplay=1",
                            duration: "48 min"
                        },
                        {
                            id: 4,
                            title: "Episodio 4",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445684874?autoplay=1",
                            duration: "44 min"
                        },
                        {
                            id: 5,
                            title: "Episodio 5",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445750410?autoplay=1",
                            duration: "46 min"
                        },
                        {
                            id: 6,
                            title: "Episodio 6",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445815946?autoplay=1",
                            duration: "43 min"
                        },
                        {
                            id: 7,
                            title: "Episodio 7",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445947018?autoplay=1",
                            duration: "47 min"
                        },
                        {
                            id: 8,
                            title: "Episodio 8",
                            thumbnail: "https://occ-0-8407-2219.1.nflxso.net/dnm/api/v6/6AYY37jfdO6hpXcMjf9Yu5cnmO0/AAAABTMz1tiwU9LLJ6ooPQ9AB5RxrGGwtnJue2ebQei9SK-ZO3TneKyCUo0hwPjG5eQgfN4LIxJE60HVN_tcD1xNn9yXGPzoWl8def4v.jpg?r=aad",
                            videoUrl: "https://ok.ru/videoembed/9067445881482?autoplay=1",
                            duration: "45 min"
                        }
                    ]
                },
                {
                    id: 2,
                    title: "W DOS MUNDOS",
                    thumbnail: "https://images.justwatch.com/poster/306331992/s718/w-dos-mundos-w-two-worlds.jpg",
                    episodes: [
                        {
                            id: 1,
                            title: "Episodio 1",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994555634?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 2,
                            title: "Episodio 2",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994490098?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 3,
                            title: "Episodio 3",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994686706?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 4,
                            title: "Episodio 4",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994621170?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 5,
                            title: "Episodio 5",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994883314?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 6,
                            title: "Episodio 6",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://video.doramedplay.net/videos/embed/vESp1Yd6mR5ft7UT2hbSZ6?title=0&warningTitle=0&peertubeLink=0&autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 7,
                            title: "Episodio 7",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994752242?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 8,
                            title: "Episodio 8",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995014386?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 9,
                            title: "Episodio 9",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882994948850?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 10,
                            title: "Episodio 10",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995604210?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 11,
                            title: "Episodio 11",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995866354?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 12,
                            title: "Episodio 12",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995669746?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 13,
                            title: "Episodio 13",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995735282?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 14,
                            title: "Episodio 14",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995473138?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 15,
                            title: "Episodio 15",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995538674?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 16,
                            title: "Episodio 16",
                            thumbnail: "https://blogger.googleusercontent.com/img/b/R29vZ2xl/AVvXsEgRFJ7h27qvHWpqmR9F9L6URd8EJ94pXZcL_mVa8g_DqWYC7k4DnmR80s2y6bXcLyvPgDlFYZDB7Hdj60DEMypLlrJC8q1cvA_6uuP_FsjzjKhZhQ6_6MJiq3u_EejVTRxtNaKsGk9xCgtz/w1200-h630-p-k-no-nu/w-01.jpg",
                            videoUrl: "https://ok.ru/videoembed/6882995800818?autoplay=1",
                            duration: "45 min"
                        }
                    ]
                },
                {
                    id: 3,
                    title: "WELCOME TO DERRY",
                    thumbnail: "https://decine21.com/img/upload/obras/it-bienvenidos-a-derry-49306/it-bienvenidos-a-derry-49306-c.jpg",
                    episodes: [
                        {
                            id: 1,
                            title: "Episodio 1",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-s5irm151bw52.html?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 2,
                            title: "Episodio 2",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-wrqr4y2zyxze.html?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 3,
                            title: "Episodio 3",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-7c1c9e9ntjoh.html?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 4,
                            title: "Episodio 4",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-291rqigd5m96.html?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 5,
                            title: "Episodio 5",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-g5v5c51szrda.html?autoplay=1",
                            duration: "45 min"
                        },
                        {
                            id: 6,
                            title: "Episodio 6",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-trhy7ny45zp0.html?autoplay=1",
                            duration: "45 min"
                        },

                         {
                            id: 7,
                            title: "Episodio 7",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://goodstream.one/embed-s4eu0r47vl40.html?autoplay=1",
                            duration: "60 min"
                        },
                         {
                            id: 8,
                            title: "Episodio 8",
                            thumbnail: "https://beam-images.warnermediacdn.com/BEAM_LWM_DELIVERABLES/6c39354a-c52d-46d7-982c-b5d196988189/bdaccda8-5e2e-4a45-bddc-33e86170f5c6?host=wbd-images.prod-vod.h264.io&partner=beamcom",
                            videoUrl: "https://vimeos.net/embed-iqm9f3jarxab.html?autoplay=1",
                            duration: "60 min"
                        }

      
                      
                    ]
                },
                {
                    id: 4,
                    title: "PRÓXIMAMENTE",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BZTE4NGZmNzktYWVhNy00OWM0LTlhZjQtMTliOTZhMWIwYjlkXkEyXkFqcGc@._V1_FMjpg_UX1000_.jpg",
                    episodes: [
                        {
                            id: 1,
                            title: "Próximamente",
                            thumbnail: "https://via.placeholder.com/300x169/1a1a1a/0066ff?text=PRÓXIMAMENTE",
                            videoUrl: "",
                            duration: "0 min"
                        }
                    ]
                }
            ];

            // Movies data - AÑADIDAS LAS NUEVAS PELÍCULAS
            const movies = [
                {
                    id: 1,
                    title: "Violet y finch",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTzRiUpHh_KyYMv-wRUl-7mpyHpHHSMI_xZ2g&s",
                    videoUrl: "https://goodstream.one/embed-d5w2t3rsciq3.html?autoplay=1"
                },
                {
                    id: 2,
                    title: "Megalodón",
                    thumbnail: "https://play-lh.googleusercontent.com/x5pAVGOSC8nYyYCskzuQAnZgrVXpzsGiYTwmCaaIt42EaLqz6Cbgr2-7rAGJM9tnA0-3-Yi2F-RAzWEZXg",
                    videoUrl: "https://vimeos.net/embed-93hu1g7z7ri2.html?autoplay=1"
                },
                {
                    id: 3,
                    title: "Comando",
                    thumbnail: "https://play-lh.googleusercontent.com/mOrCRf5pW60MbWz0WfvtYDBsFlTf-E_cZtLrkqsfCHh010GDyXnembxSIIXUonJvbVs",
                    videoUrl: "https://vimeos.net/embed-bxaelsf5kt7r.html?autoplay=1"
                },
                {
                    id: 4,
                    title: "El Grinch",
                    thumbnail: "https://i.pinimg.com/736x/46/7f/bb/467fbbed233c10f94ad0bd29671a3c73.jpg",
                    videoUrl: "https://vimeos.net/embed-b9ndtepqzs2n.html?autoplay=1"
                },
                {
                    id: 5,
                    title: "El gato",
                    thumbnail: "https://pics.filmaffinity.com/El_gato-437054652-large.jpg",
                    videoUrl: "https://vimeos.net/embed-2z1ajv3exi7a.html?autoplay=1"
                },
                {
                    id: 6,
                    title: "Lilo & Stitch",
                    thumbnail: "https://cdn.bolivia.com/cine/2025/5/lilo-stitch-44922-1.jpg",
                    videoUrl: "https://vimeos.net/embed-ph8dhp41s8sp.html?autoplay=1"
                },
                {
                    id: 7,
                    title: "Conjuro los últimos ritos",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BM2VmMzRkYzgtMzg2ZC00OTFkLTkwMTYtNTMxNjM2YzI1MjgyXkEyXkFqcGc@._V1_.jpg",
                    videoUrl: "https://vimeos.net/embed-pazypz5yf1vk.html?autoplay=1"
                },
                {
                    id: 8,
                    title: "IT Capítulo 2",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BYTJlNjlkZTktNjEwOS00NzI5LTlkNDAtZmEwZDFmYmM2MjU2XkEyXkFqcGdeQXVyNjg2NjQwMDQ@._V1_FMjpg_UX1000_.jpg",
                    videoUrl: "https://vimeos.net/embed-rnuv57supb0c.html?autoplay=1"
                },
                {
                    id: 9,
                    title: "Jurassic World: Renace",
                    thumbnail: "https://play-lh.googleusercontent.com/C-NoJBT8ZEZ0MJJ0XYiyG_ndIB6ML0j4Db1uAap3nBsLlQ6x8o7x8lC0hywKDDOQmj8aswcUUH1fEIjPqadc",
                    videoUrl: "https://vimeos.net/embed-r5xuubxljw1k.html?autoplay=1"
                },
                {
                    id: 10,
                    title: "El rey león",
                    thumbnail: "https://images.justwatch.com/poster/216939227/s718/el-rey-leon-2019.jpg",
                    videoUrl: "https://vimeos.net/embed-hlhjvf7dqrlm.html?autoplay=1"
                },
                {
                    id: 11,
                    title: "La era de hielo 3",
                    thumbnail: "https://play-lh.googleusercontent.com/q2VcIaw7wp_dqWXoBJ2YUoVpJzAFDLPW825poUAkrLCJYLt4wIDzAMWmFZYU33gHxI1Oof351IcA9n8E3A",
                    videoUrl: "https://vimeos.net/embed-zvdiseyr8cmn.html?autoplay=1"
                },
                {
                    id: 12,
                    title: "Dragon Ball Z: La Batalla de los Dioses",
                    thumbnail: "https://es.web.img3.acsta.net/pictures/14/03/13/09/32/445665.jpg",
                    videoUrl: "https://vimeos.net/embed-5jns0lh0vtvn.html?autoplay=1"
                },
                {
                    id: 13,
                    title: "Home",
                    thumbnail: "https://m.media-amazon.com/images/S/pv-target-images/0c2b46241fcbc4ec5d9ed797509e2d9290bf44a538c08ab33ac7addb70bcb444.jpg",
                    videoUrl: "https://vimeos.net/embed-ifjmc7q23yma.html?autoplay=1"
                },
                {
                    id: 14,
                    title: "Dragon Ball Super: Broly",
                    thumbnail: "https://play-lh.googleusercontent.com/EtlRs463VNW5xUAWAkSc9Tl_fSczDBfCZDvRgkNtGUU-S1LdJuaHRBcQrPcF5_whMyD9",
                    videoUrl: "https://vimeos.net/embed-4pkxjoigiw3o.html?autoplay=1"
                },
                {
                    id: 15,
                    title: "Mufasa: El rey león",
                    thumbnail: "https://lumiere-a.akamaihd.net/v1/images/image_956cb480.jpeg",
                    videoUrl: "https://vimeos.net/embed-as79zsodqldc.html?autoplay=1"
                },
                {
                    id: 16,
                    title: "IntensaMente 2",
                    thumbnail: "https://m.media-amazon.com/images/I/61PRJC2fyFL._AC_UF894,1000_QL80_.jpg",
                    videoUrl: "https://vimeos.net/embed-ygqbs42hctbc.html?autoplay=1"
                },
                {
                    id: 17,
                    title: "Mulán",
                    thumbnail: "https://images.justwatch.com/poster/160494160/s718/mulan.jpg",
                    videoUrl: "https://vimeos.net/embed-fq7uuv7e3v1b.html?autoplay=1"
                },
                {
                    id: 18,
                    title: "Kung Fu Panda 3",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BMTUyNzgxNjg2M15BMl5BanBnXkFtZTgwMTY1NDI1NjE@._V1_FMjpg_UX1000_.jpg",
                    videoUrl: "https://vimeos.net/embed-lr3dbb6qkaus.html?autoplay=1"
                },
                {
                    id: 19,
                    title: "Travesuras de una Sirena",
                    thumbnail: "https://media.themoviedb.org/t/p/w500/eS8OzNBjzzQ3939zkAuyOvaUa9I.jpg",
                    videoUrl: "https://vimeos.net/embed-qoecdif7v94a.html?autoplay=1"
                },
                {
                    id: 20,
                    title: "No manches, Frida",
                    thumbnail: "https://images.justwatch.com/poster/178024449/s718/no-manches-frida.jpg",
                    videoUrl: "https://vimeos.net/embed-w1tvsup2nlib.html?autoplay=1"
                },
                {
                    id: 21,
                    title: "No manches, Frida 2",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BMzYzNjEyMTUtOGI2Ny00MzM4LWIxNGYtMmIzNzA0Y2ZkMjkwXkEyXkFqcGc@._V1_FMjpg_UX1000_.jpg",
                    videoUrl: "https://vimeos.net/embed-6rtb5tel8gba.html?autoplay=1"
                },
                {
                    id: 22,
                    title: "Culpa nuestra",
                    thumbnail: "https://preview.redd.it/our-fault-honestly-whose-fault-is-this-movie-v0-yf9g2npsfjvf1.jpeg?auto=webp&s=5cf10f8e3f6ac8bf33c24071f09fc08a4d6efc48",
                    videoUrl: "https://vimeos.net/embed-dhvfk41hw7n1.html?autoplay=1"
                },
                {
                    id: 23,
                    title: "Crepúsculo: Amanecer 2",
                    thumbnail: "https://es.web.img2.acsta.net/img/f2/5b/f25bd4625eaac9e94e6e277eb57879b2.jpg",
                    videoUrl: "https://vimeos.net/embed-d8pblodfnu18.html?autoplay=1"
                },
                {
                    id: 24,
                    title: "Escuadrón Suicida",
                    thumbnail: "https://play-lh.googleusercontent.com/kCE9Fu7Jxgy3Jd_64GHj6Nxvknk2mKInixiA2aFB0ynrqw87UN-mV4Uz1-c0CMxTyOlP-idh7zSqjy4_3PU",
                    videoUrl: "https://vimeos.net/embed-r4ceg4sehyz7.html?autoplay=1"
                },
                {
                    id: 25,
                    title: "Rápidos y furiosos 9",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BMjI0NmFkYzEtNzU2YS00NTg5LWIwYmMtNmQ1MTU0OGJjOTMxXkEyXkFqcGdeQXVyMjMxOTE0ODA@._V1_FMjpg_UX1000_.jpg",
                    videoUrl: "https://vimeos.net/embed-cmslrswu6amy.html?autoplay=1"
                },
                {
                    id: 26,
                    title: "Avengers: Infinity War",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BMjMxNjY2MDU1OV5BMl5BanBnXkFtZTgwNzY1MTUwNTM@._V1_FMjpg_UX1000_.jpg",
                    videoUrl: "https://vimeos.net/embed-8tnt1gibf2r7.html?autoplay=1"
                },
                   {
                    id: 27,
                    title: "Ted",
                    thumbnail: "https://es.web.img3.acsta.net/medias/nmedia/18/86/62/03/20141188.jpg",
                    videoUrl: "https://vimeos.net/embed-7f9rmyarlq89.html?autoplay=1"
                },
                   {
                    id: 28,
                    title: "Ted 2",
                    thumbnail: "https://m.media-amazon.com/images/M/MV5BZmYwZGZhNjYtZmVjNy00ZGQ5LWJlOTAtZGMzYjE5NWM0NTA1XkEyXkFqcGc@._V1_.jpg",
                    videoUrl: "https://vimeos.net/embed-jlim2kn823lq.html?autoplay=1"
                },
                {
                    id: 29,
                    title: "Deadpool",
                    thumbnail: "https://upload.wikimedia.org/wikipedia/en/thumb/2/23/Deadpool_%282016_poster%29.png/250px-Deadpool_%282016_poster%29.png",
                    videoUrl: "https://vimeos.net/embed-eqs0mdqw1s2a.html?autoplay=1"
                },
                {
                    id: 30,
                    title: "Deadpool 2",
                    thumbnail: "https://play-lh.googleusercontent.com/yRsSsSFyX2V4S2x6NZyFoXaAeWbPb3rgPjdVGo4K4yAugSBPTfK0tSwdC3JNEoYT1MO8",
                    videoUrl: "https://vimeos.net/embed-q8qaw1xrw7i4.html?autoplay=1"
                },
                {
                    id: 31,
                    title: "Deadpool & Wolverine",
                    thumbnail: "https://play-lh.googleusercontent.com/1U2OL8rKUETWnCrfEkDd2aFK0UP_TdumQP3arOwT086ZQ4L28MP2zqJ8ILSbJ8hcOI5bpsaiU2xJs7Fefw=w240-h480-rw",
                    videoUrl: "https://vimeos.net/embed-mezccka8xc2k.html?autoplay=1"
                },
                 {
                    id: 32,
                    title: "Aladin New",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcTZ_GZpwcQ1c0Bc-QXKe02LUI3IOCUA-CHHZg&s",
                    videoUrl: "https://goodstream.one/embed-azraq3gkzkrb.html?autoplay=1"
                },
                {
                    id: 33,
                    title: "Tierra de osos 2",
                    thumbnail: "https://play-lh.googleusercontent.com/Gs02Xi4MNLhESjMUy9MaCCLN8OEP_-dvzGpwrjl07bxwX4EBoiXfYfcqh1EA8Xbnc01aHA",
                    videoUrl: "https://goodstream.one/embed-nlelmfynwyvz.html?autoplay=1"
                },
                {
                    id: 34,
                    title: "Leroy y stitch",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcRnuxD78dj0CoZfKbfcQ87HHafJm4QV4LZNkg&s",
                    videoUrl: "https://goodstream.one/embed-dpxhfzd4rx0g.html?autoplay=1"
                },
                 {
                    id: 35,
                    title: "Castillo de diamantes barbie",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQQ2IYVh9zttIQYvtnkigCuFPxSNjIPcLOGkQ&s",
                    videoUrl: "https://goodstream.one/embed-0br6vonbomw1.html?autoplay=1"
                },
                {
                    id: 36,
                    title: "Horton",
                    thumbnail: "https://images.justwatch.com/poster/306674711/s718/horton.jpg",
                    videoUrl: "https://goodstream.one/embed-6nimg92i9lrx.html?autoplay=1"
                },
                {
                    id: 37,
                    title: "Iron man",
                    thumbnail: "https://play-lh.googleusercontent.com/ApsXleoHgQcQdN_tD4BzDyGRFSYFb2xDuRnuUOupMc-KZ2SH_Jc-9iwAKfVpRrmnd6_-",
                    videoUrl: "https://goodstream.one/embed-uvbpmxry7xum.html?autoplay=1"
                },
                {
                    id: 38,
                    title: "Iron man 2 ",
                    thumbnail: "https://images.justwatch.com/poster/305489899/s718/iron-man-2.jpg",
                    videoUrl: "https://goodstream.one/embed-k01cp333apxh.html?autoplay=1"
                },
                {
                    id: 40,
                    title: "Iron man 3 ",
                    thumbnail: "https://upload.wikimedia.org/wikipedia/en/1/19/Iron_Man_3_poster.jpg",
                    videoUrl: "https://goodstream.one/embed-tryal1du9wj7.html?autoplay=1"
                },
                {
                    id: 41,
                    title: "Guardianes de la galaxia",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcSofXKE1i8Ja43YBuBsVTO0cooXNecoWRIF-g&s",
                    videoUrl: "https://goodstream.one/embed-uvdg4t456is3.html?autoplay=1"
                },
                {
                    id: 42,
                    title: "Guardianes de la galaxia 2",
                    thumbnail: "https://play-lh.googleusercontent.com/OsxhsRDFDPTrTmZHB5ZKeLWij5q10mStIIBAS8ed3XXlLcl_gNu1xulLDfQ_r6ZSXtM",
                    videoUrl: "https://goodstream.one/embed-wynedordt2fz.html?autoplay=1"
                },
                {
                    id: 43,
                    title: "Guardianes de la galaxia 3",
                    thumbnail: "https://lumiere-a.akamaihd.net/v1/images/lat_2ae5e247.jpeg",
                    videoUrl: "https://goodstream.one/embed-1enyfzj1nem7.html?autoplay=1"
                },
                {
                    id: 44,
                    title: "Avengers end game",
                    thumbnail: "https://encrypted-tbn0.gstatic.com/images?q=tbn:ANd9GcQ6A7nL2eMcngRt92Q4OCapRlngpF9p3baoWw&s",
                    videoUrl: "https://goodstream.one/embed-eojplsyjbb93.html?autoplay=1"
                },
                {
                    id: 45,
                    title: "Avengers 2 era de ultron",
                    thumbnail: "https://es.web.img3.acsta.net/pictures/15/02/25/10/37/363909.jpg",
                    videoUrl: "https://goodstream.one/embed-dnbnjb8ltj5l.html?autoplay=1"
                },
                {
                    id: 46,
                    title: "Thor y trueno",
                    thumbnail: "https://lumiere-a.akamaihd.net/v1/images/poster_thor_amor_y_trueno_cd37979a.jpeg?region=0,0,1080,1350",
                    videoUrl: "https://goodstream.one/embed-uq2xl4lrae74.html?autoplay=1"
                },
                {

                    id: 47,
                    title: "Zootopia",
                    thumbnail: "https://lumiere-a.akamaihd.net/v1/images/movie_poster_zootopia_866a1bf2.jpeg?region=0%2C0%2C300%2C450",
                    videoUrl: "https://vimeos.net/embed-ecahshgr021m.html?autoplay=1"
                }
              
            ];
            
            // ========== APLICACIÓN MÓVIL ==========
            function initializeMobileApp() {
                appContainer.classList.add('loaded');
                createSnowflakes();
                
                // DOM Elements
                const settingsBtn = document.getElementById('settings-btn');
                const settingsModal = document.getElementById('settings-modal');
                const closeSettingsBtn = document.getElementById('close-settings');
                const footerNavBtns = document.querySelectorAll('.mobile-layout .footer-nav-btn');
                const contentSections = document.querySelectorAll('.mobile-layout .content-section');
                const channelsGrid = document.getElementById('channels-grid');
                const allChannelsGrid = document.getElementById('all-channels-grid');
                const seriesGrid = document.getElementById('series-grid');
                const moviesGrid = document.getElementById('movies-grid');
                const fullscreenPlayer = document.getElementById('fullscreen-player');
                const seriesFullscreenPlayer = document.getElementById('series-fullscreen-player');
                const moviesFullscreenPlayer = document.getElementById('movies-fullscreen-player');
                const fullscreenIframeContainer = document.getElementById('fullscreen-iframe-container');
                const seriesIframe = document.getElementById('series-iframe');
                const moviesIframe = document.getElementById('movies-iframe');
                const seriesSelectionModal = document.getElementById('series-selection-modal');
                const closeSeriesModalBtn = document.getElementById('close-series-modal');
                const episodesGrid = document.getElementById('episodes-grid');
                const seriesModalTitle = document.getElementById('series-modal-title');
                
                // Current playing channel
                let currentChannel = null;
                let isFullscreen = false;
                let currentChannelIndex = 0;
                let currentSeries = null;
                let isInSeriesModal = false;

                // Setup event listeners
                function setupEventListeners() {
                    settingsBtn.addEventListener('click', openSettings);
                    closeSettingsBtn.addEventListener('click', closeSettings);
                    closeSeriesModalBtn.addEventListener('click', closeSeriesSelection);
                    
                    footerNavBtns.forEach(btn => {
                        btn.addEventListener('click', function() {
                            const section = this.dataset.section;
                            showSection(section);
                            setActiveFooterNav(this);
                        });
                    });
                    
                    // Touch events for channel switching in fullscreen
                    document.addEventListener('touchstart', handleTouchStart, false);
                    document.addEventListener('touchmove', handleTouchMove, false);

                    // Series fullscreen close on click
                    seriesFullscreenPlayer.addEventListener('click', exitSeriesFullscreen);
                    
                    // Movies fullscreen close on click
                    moviesFullscreenPlayer.addEventListener('click', exitMoviesFullscreen);
                    
                    // Close series selection modal when clicking outside
                    seriesSelectionModal.addEventListener('click', function(e) {
                        if (e.target === seriesSelectionModal) {
                            closeSeriesSelection();
                        }
                    });

                    // Settings modal close on click outside
                    settingsModal.addEventListener('click', function(e) {
                        if (e.target === settingsModal) {
                            closeSettings();
                        }
                    });
                    
                    // Handle browser back button
                    window.addEventListener('popstate', handleBackButton);
                }

                // Touch controls para cambiar canales
                let xDown = null;
                let yDown = null;

                function handleTouchStart(evt) {
                    if (!isFullscreen) return;
                    
                    const firstTouch = evt.touches[0];
                    xDown = firstTouch.clientX;
                    yDown = firstTouch.clientY;
                }

                function handleTouchMove(evt) {
                    if (!xDown || !yDown || !isFullscreen) return;

                    const xUp = evt.touches[0].clientX;
                    const yUp = evt.touches[0].clientY;

                    const xDiff = xDown - xUp;
                    const yDiff = yDown - yUp;

                    if (Math.abs(xDiff) > Math.abs(yDiff)) {
                        if (xDiff > 0) {
                            changeChannel(1);
                        } else {
                            changeChannel(-1);
                        }
                    }

                    xDown = null;
                    yDown = null;
                }

                // Cambiar canal (dirección: -1 para anterior, 1 para siguiente)
                function changeChannel(direction) {
                    currentChannelIndex += direction;
                    
                    if (currentChannelIndex < 0) {
                        currentChannelIndex = channels.length - 1;
                    } else if (currentChannelIndex >= channels.length) {
                        currentChannelIndex = 0;
                    }
                    
                    playChannelFullscreen(channels[currentChannelIndex]);
                    showChannelChangeNotification(channels[currentChannelIndex].title);
                }

                // Cambiar a canal específico
                function changeToChannel(index) {
                    if (index >= 0 && index < channels.length) {
                        currentChannelIndex = index;
                        playChannelFullscreen(channels[currentChannelIndex]);
                        showChannelChangeNotification(channels[currentChannelIndex].title);
                    }
                }

                // Mostrar notificación de cambio de canal
                function showChannelChangeNotification(channelName) {
                    const existingNotification = document.querySelector('.channel-change-notification');
                    if (existingNotification) {
                        existingNotification.remove();
                    }
                    
                    const notification = document.createElement('div');
                    notification.className = 'channel-change-notification';
                    notification.innerHTML = `
                        <div class="notification-content">
                            <span class="channel-number">${currentChannelIndex + 1}</span>
                            <span class="channel-name">${channelName}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.opacity = '0';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }, 2000);
                }

                // Setup auto fullscreen functionality
                function setupAutoFullscreen() {
                    const observer = new MutationObserver(function(mutations) {
                        mutations.forEach(function(mutation) {
                            if (mutation.type === 'childList' && fullscreenIframeContainer.children.length > 0) {
                                enterFullscreen();
                            }
                        });
                    });
                    
                    observer.observe(fullscreenIframeContainer, { childList: true });
                }

                // Enter fullscreen mode
                function enterFullscreen() {
                    removeSnowflakes(); // Remove snowflakes in fullscreen
                    fullscreenPlayer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    isFullscreen = true;
                    currentChannelIndex = channels.findIndex(ch => ch.id === currentChannel.id);
                    
                    // Push state to handle back button
                    window.history.pushState({ page: 'fullscreen' }, '', '#fullscreen');
                    
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                        });
                    }
                    
                    addTVControls();
                }

                // Agregar controles de TV en pantalla completa
                function addTVControls() {
                    const existingControls = document.querySelector('.tv-controls-overlay');
                    if (existingControls) {
                        existingControls.remove();
                    }
                    
                    const controls = document.createElement('div');
                    controls.className = 'tv-controls-overlay';
                    controls.innerHTML = `
                        <div class="tv-controls-info">
                            <div class="current-channel">${currentChannel.title}</div>
                            <div class="tv-instructions">
                                Desliza para cambiar canal | Toca para salir
                            </div>
                        </div>
                    `;
                    
                    fullscreenPlayer.appendChild(controls);
                    
                    setTimeout(() => {
                        controls.style.opacity = '0';
                    }, 5000);
                    
                    fullscreenPlayer.addEventListener('touchstart', showTVControls);
                    
                    function showTVControls() {
                        controls.style.opacity = '1';
                        setTimeout(() => {
                            controls.style.opacity = '0';
                        }, 5000);
                    }
                }

                // Exit fullscreen mode
                function exitFullscreen() {
                    restoreSnowflakes(); // Restore snowflakes when exiting fullscreen
                    fullscreenPlayer.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    isFullscreen = false;
                    
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    }
                    
                    fullscreenIframeContainer.innerHTML = '';
                    
                    const controls = document.querySelector('.tv-controls-overlay');
                    if (controls) {
                        controls.remove();
                    }
                    
                    fullscreenPlayer.removeEventListener('touchstart', showTVControls);
                    
                    // Update history state
                    if (window.history.state && window.history.state.page === 'fullscreen') {
                        window.history.back();
                    }
                }

                // Open settings modal
                function openSettings() {
                    settingsModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    window.history.pushState({ page: 'settings' }, '', '#settings');
                }

                // Close settings modal
                function closeSettings() {
                    settingsModal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    if (window.history.state && window.history.state.page === 'settings') {
                        window.history.back();
                    }
                }

                // Show selected section
                function showSection(sectionId) {
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    document.getElementById(`${sectionId}-section`).classList.add('active');
                    
                    // Update URL hash
                    window.history.pushState({ page: sectionId }, '', `#${sectionId}`);
                }

                // Set active footer navigation
                function setActiveFooterNav(activeItem) {
                    footerNavBtns.forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    activeItem.classList.add('active');
                }

                // Render channels to the grids
                function renderChannels() {
                    channelsGrid.innerHTML = '';
                    allChannelsGrid.innerHTML = '';
                    
                    channels.forEach((channel, index) => {
                        const channelCard = createChannelCard(channel, index);
                        channelsGrid.appendChild(channelCard);
                        
                        const fullChannelCard = createChannelCard(channel, index);
                        allChannelsGrid.appendChild(fullChannelCard);
                    });
                }

                // Create channel card element
                function createChannelCard(channel, index) {
                    const card = document.createElement('div');
                    card.className = 'channel-card';
                    card.dataset.id = channel.id;
                    
                    card.innerHTML = `
                        <div class="channel-thumbnail">
                            <img src="${channel.thumbnail}" alt="${channel.title}" loading="lazy">
                            <span class="channel-live-badge">EN VIVO</span>
                            <span class="channel-number">${index + 1}</span>
                        </div>
                        <div class="channel-title">${channel.title}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        playChannelFullscreen(channel);
                    });
                    
                    return card;
                }

                // Play channel in fullscreen
                function playChannelFullscreen(channel) {
                    currentChannel = channel;
                    currentChannelIndex = channels.findIndex(ch => ch.id === channel.id);
                    fullscreenIframeContainer.innerHTML = channel.iframeCode;
                }

                // Render series to the grid
                function renderSeries() {
                    seriesGrid.innerHTML = '';
                    
                    series.forEach((serie, index) => {
                        const seriesCard = createSeriesCard(serie, index);
                        seriesGrid.appendChild(seriesCard);
                    });
                }

                // Create series card element
                function createSeriesCard(serie, index) {
                    const card = document.createElement('div');
                    card.className = 'series-card';
                    card.dataset.id = serie.id;
                    
                    card.innerHTML = `
                        <div class="series-thumbnail">
                            <img src="${serie.thumbnail}" alt="${serie.title}" loading="lazy">
                        </div>
                        <div class="series-title">${serie.title}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        openSeriesSelection(serie);
                    });
                    
                    return card;
                }

                // Render movies to the grid
                function renderMovies() {
                    moviesGrid.innerHTML = '';
                    
                    movies.forEach((movie, index) => {
                        const movieCard = createMovieCard(movie, index);
                        moviesGrid.appendChild(movieCard);
                    });
                }

                // Create movie card element
                function createMovieCard(movie, index) {
                    const card = document.createElement('div');
                    card.className = 'movie-card';
                    card.dataset.id = movie.id;
                    
                    card.innerHTML = `
                        <div class="movie-thumbnail">
                            <img src="${movie.thumbnail}" alt="${movie.title}" loading="lazy">
                        </div>
                        <div class="movie-title">${movie.title}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        playMovieFullscreen(movie);
                    });
                    
                    return card;
                }

                // Open series selection modal
                function openSeriesSelection(serie) {
                    currentSeries = serie;
                    isInSeriesModal = true;
                    seriesModalTitle.textContent = serie.title;
                    episodesGrid.innerHTML = '';
                    
                    serie.episodes.forEach((episode, index) => {
                        const episodeCard = createEpisodeCard(episode, index);
                        episodesGrid.appendChild(episodeCard);
                    });
                    
                    seriesSelectionModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Push state to handle back button
                    window.history.pushState({ page: 'series-modal' }, '', '#series-modal');
                }

                // Create episode card element - AHORA INCLUYE NÚMERO DE EPISODIO SIEMPRE VISIBLE
                function createEpisodeCard(episode, index) {
                    const card = document.createElement('div');
                    card.className = 'episode-card';
                    card.dataset.id = episode.id;
                    
                    card.innerHTML = `
                        <div class="episode-thumbnail">
                            <img src="${episode.thumbnail}" alt="${episode.title}" loading="lazy">
                            <div class="episode-number-badge">${index + 1}</div>
                        </div>
                        <div class="episode-info">
                            <div class="episode-title">${episode.title}</div>
                            <div class="episode-duration">${episode.duration}</div>
                        </div>
                    `;
                    
                    card.addEventListener('click', function() {
                        if (episode.videoUrl) {
                            playSeriesFullscreen(episode.videoUrl);
                            closeSeriesSelection();
                        }
                    });
                    
                    return card;
                }

                // Close series selection modal
                function closeSeriesSelection() {
                    seriesSelectionModal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    isInSeriesModal = false;
                    
                    // Update history state
                    if (window.history.state && window.history.state.page === 'series-modal') {
                        window.history.back();
                    }
                }

                // Play series in fullscreen
                function playSeriesFullscreen(videoUrl) {
                    removeSnowflakes(); // Remove snowflakes in fullscreen
                    seriesIframe.src = videoUrl;
                    seriesFullscreenPlayer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Push state to handle back button
                    window.history.pushState({ page: 'series-fullscreen' }, '', '#series-fullscreen');
                    
                    // Entrar automáticamente en pantalla completa
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                        });
                    }
                    
                    // Forzar el sonido (esto depende de las políticas del navegador)
                    setTimeout(() => {
                        try {
                            seriesIframe.contentWindow.postMessage('{"func":"playVideo"}', '*');
                        } catch(e) {
                            console.log('No se pudo forzar reproducción automática');
                        }
                    }, 1000);
                }

                // Play movie in fullscreen
                function playMovieFullscreen(movie) {
                    removeSnowflakes(); // Remove snowflakes in fullscreen
                    moviesIframe.src = movie.videoUrl;
                    moviesFullscreenPlayer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Push state to handle back button
                    window.history.pushState({ page: 'movie-fullscreen' }, '', '#movie-fullscreen');
                    
                    // Entrar automáticamente en pantalla completa
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                        });
                    }
                    
                    // Forzar el sonido (esto depende de las políticas del navegador)
                    setTimeout(() => {
                        try {
                            moviesIframe.contentWindow.postMessage('{"func":"playVideo"}', '*');
                        } catch(e) {
                            console.log('No se pudo forzar reproducción automática');
                        }
                    }, 1000);
                }

                // Exit series fullscreen
                function exitSeriesFullscreen() {
                    restoreSnowflakes(); // Restore snowflakes when exiting fullscreen
                    seriesFullscreenPlayer.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    seriesIframe.src = '';
                    
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    }
                    
                    // Update history state
                    if (window.history.state && window.history.state.page === 'series-fullscreen') {
                        window.history.back();
                    }
                }

                // Exit movies fullscreen
                function exitMoviesFullscreen() {
                    restoreSnowflakes(); // Restore snowflakes when exiting fullscreen
                    moviesFullscreenPlayer.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    moviesIframe.src = '';
                    
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    }
                    
                    // Update history state
                    if (window.history.state && window.history.state.page === 'movie-fullscreen') {
                        window.history.back();
                    }
                }

                // Handle browser back button
                function handleBackButton(event) {
                    if (seriesFullscreenPlayer.classList.contains('active')) {
                        exitSeriesFullscreen();
                        event.preventDefault();
                        return false;
                    } else if (moviesFullscreenPlayer.classList.contains('active')) {
                        exitMoviesFullscreen();
                        event.preventDefault();
                        return false;
                    } else if (isFullscreen) {
                        exitFullscreen();
                        event.preventDefault();
                        return false;
                    } else if (seriesSelectionModal.classList.contains('active')) {
                        closeSeriesSelection();
                        event.preventDefault();
                        return false;
                    } else if (settingsModal.classList.contains('active')) {
                        closeSettings();
                        event.preventDefault();
                        return false;
                    } else {
                        // Default back behavior - show home section
                        showSection('home');
                        setActiveFooterNav(document.querySelector('.mobile-layout .footer-nav-btn[data-section="home"]'));
                    }
                }

                // Initialize the mobile app
                setupEventListeners();
                renderChannels();
                renderSeries();
                renderMovies();
                showSection('home');
                setupAutoFullscreen();
                
                // Initialize history state
                window.history.replaceState({ page: 'home' }, '', '#home');
            }

            // ========== APLICACIÓN TV ==========
            function initializeTVApp() {
                tvAppContainer.classList.add('loaded');
                createSnowflakes();
                
                // DOM Elements
                const settingsBtn = document.getElementById('tv-settings-btn');
                const settingsModal = document.getElementById('settings-modal');
                const closeSettingsBtn = document.getElementById('close-settings');
                const navBtns = document.querySelectorAll('.tv-layout .nav-btn');
                const contentSections = document.querySelectorAll('.tv-layout .content-section');
                const channelsGrid = document.getElementById('tv-channels-grid');
                const allChannelsGrid = document.getElementById('tv-all-channels-grid');
                const seriesGrid = document.getElementById('tv-series-grid');
                const moviesGrid = document.getElementById('tv-movies-grid');
                const fullscreenPlayer = document.getElementById('fullscreen-player');
                const seriesFullscreenPlayer = document.getElementById('series-fullscreen-player');
                const moviesFullscreenPlayer = document.getElementById('movies-fullscreen-player');
                const fullscreenIframeContainer = document.getElementById('fullscreen-iframe-container');
                const seriesIframe = document.getElementById('series-iframe');
                const moviesIframe = document.getElementById('movies-iframe');
                const seriesSelectionModal = document.getElementById('series-selection-modal');
                const closeSeriesModalBtn = document.getElementById('close-series-modal');
                const episodesGrid = document.getElementById('episodes-grid');
                const seriesModalTitle = document.getElementById('series-modal-title');
                
                // Current playing channel
                let currentChannel = null;
                let isFullscreen = false;
                let currentChannelIndex = 0;
                let currentSeries = null;

                // TV Remote Navigation Variables
                let currentFocus = {
                    section: 'home',
                    elementIndex: 0,
                    type: 'channel' // 'channel', 'series', 'movie', 'nav', 'episode'
                };

                // Setup event listeners
                function setupEventListeners() {
                    settingsBtn.addEventListener('click', openSettings);
                    closeSettingsBtn.addEventListener('click', closeSettings);
                    closeSeriesModalBtn.addEventListener('click', closeSeriesSelection);
                    
                    navBtns.forEach((btn, index) => {
                        btn.addEventListener('click', function() {
                            const section = this.dataset.section;
                            showSection(section);
                            setActiveNav(this);
                            
                            // Set focus to first item in the section
                            if (section === 'home' || section === 'channels') {
                                setFocus(section, 0, 'channel');
                            } else if (section === 'series') {
                                setFocus('series', 0, 'series');
                            } else if (section === 'movies') {
                                setFocus('movies', 0, 'movie');
                            }
                        });
                    });
                    
                    // Keyboard controls for TV remote
                    document.addEventListener('keydown', handleKeyboard);
                    
                    // Series fullscreen close on click
                    seriesFullscreenPlayer.addEventListener('click', exitSeriesFullscreen);
                    
                    // Movies fullscreen close on click
                    moviesFullscreenPlayer.addEventListener('click', exitMoviesFullscreen);
                    
                    // Close series selection modal when clicking outside
                    seriesSelectionModal.addEventListener('click', function(e) {
                        if (e.target === seriesSelectionModal) {
                            closeSeriesSelection();
                        }
                    });

                    // Settings modal close on click outside
                    settingsModal.addEventListener('click', function(e) {
                        if (e.target === settingsModal) {
                            closeSettings();
                        }
                    });
                }

                // Setup TV Navigation
                function setupTVNavigation() {
                    // Add selection indicators to all focusable elements
                    document.querySelectorAll('.tv-layout .channel-card, .tv-layout .series-card, .tv-layout .movie-card, .tv-layout .nav-btn, .tv-layout .episode-card, .tv-layout .close-modal, .tv-layout .btn-primary').forEach(el => {
                        const indicator = document.createElement('div');
                        indicator.className = 'selection-indicator';
                        el.appendChild(indicator);
                    });

                    // Set initial focus
                    setFocus('home', 0, 'channel');
                }

                // Set focus to specific element
                function setFocus(section, index, type) {
                    // Remove focus from all elements
                    document.querySelectorAll('.tv-layout .focused').forEach(el => {
                        el.classList.remove('focused');
                    });

                    currentFocus.section = section;
                    currentFocus.elementIndex = index;
                    currentFocus.type = type;

                    let element;

                    switch(type) {
                        case 'channel':
                            const channelGrid = section === 'home' ? channelsGrid : allChannelsGrid;
                            element = channelGrid.children[index];
                            break;
                        case 'series':
                            element = seriesGrid.children[index];
                            break;
                        case 'movie':
                            element = moviesGrid.children[index];
                            break;
                        case 'nav':
                            element = navBtns[index];
                            break;
                        case 'episode':
                            element = episodesGrid.children[index];
                            break;
                        case 'close':
                            element = closeSeriesModalBtn;
                            break;
                        case 'button':
                            element = closeSettingsBtn;
                            break;
                    }

                    if (element) {
                        element.classList.add('focused');
                        element.scrollIntoView({ behavior: 'smooth', block: 'center' });
                    }
                }

                // Handle TV Remote Navigation
                function handleTVNavigation(direction) {
                    if (isFullscreen || seriesFullscreenPlayer.classList.contains('active') || moviesFullscreenPlayer.classList.contains('active')) {
                        // Navigation in fullscreen mode
                        if (direction === 'left') {
                            changeChannel(-1);
                        } else if (direction === 'right') {
                            changeChannel(1);
                        } else if (direction === 'back') {
                            if (seriesFullscreenPlayer.classList.contains('active')) {
                                exitSeriesFullscreen();
                            } else if (moviesFullscreenPlayer.classList.contains('active')) {
                                exitMoviesFullscreen();
                            } else {
                                exitFullscreen();
                            }
                        }
                        return;
                    }

                    if (seriesSelectionModal.classList.contains('active')) {
                        // Navigation in series selection modal
                        handleEpisodeNavigation(direction);
                        return;
                    }

                    // Navigation in main interface
                    switch(currentFocus.type) {
                        case 'channel':
                            handleChannelNavigation(direction);
                            break;
                        case 'series':
                            handleSeriesNavigation(direction);
                            break;
                        case 'movie':
                            handleMovieNavigation(direction);
                            break;
                        case 'nav':
                            handleNavNavigation(direction);
                            break;
                    }
                }

                // Handle channel navigation
                function handleChannelNavigation(direction) {
                    const grid = currentFocus.section === 'home' ? channelsGrid : allChannelsGrid;
                    const itemsPerRow = Math.floor(grid.offsetWidth / 220); // Approximate items per row
                    const totalItems = grid.children.length;

                    let newIndex = currentFocus.elementIndex;

                    switch(direction) {
                        case 'up':
                            if (currentFocus.section === 'home') {
                                setFocus('home', 0, 'nav');
                            } else {
                                newIndex = Math.max(0, newIndex - itemsPerRow);
                            }
                            break;
                        case 'down':
                            if (currentFocus.section === 'home') {
                                setFocus('home', 0, 'nav');
                            } else {
                                newIndex = Math.min(totalItems - 1, newIndex + itemsPerRow);
                            }
                            break;
                        case 'left':
                            newIndex = Math.max(0, newIndex - 1);
                            break;
                        case 'right':
                            newIndex = Math.min(totalItems - 1, newIndex + 1);
                            break;
                        case 'select':
                            const channel = channels[newIndex];
                            playChannelFullscreen(channel);
                            break;
                    }

                    if (newIndex !== currentFocus.elementIndex) {
                        setFocus(currentFocus.section, newIndex, 'channel');
                    }
                }

                // Handle series navigation
                function handleSeriesNavigation(direction) {
                    const itemsPerRow = Math.floor(seriesGrid.offsetWidth / 220); // Approximate items per row
                    const totalItems = seriesGrid.children.length;

                    let newIndex = currentFocus.elementIndex;

                    switch(direction) {
                        case 'up':
                            newIndex = Math.max(0, newIndex - itemsPerRow);
                            break;
                        case 'down':
                            newIndex = Math.min(totalItems - 1, newIndex + itemsPerRow);
                            break;
                        case 'left':
                            newIndex = Math.max(0, newIndex - 1);
                            break;
                        case 'right':
                            newIndex = Math.min(totalItems - 1, newIndex + 1);
                            break;
                        case 'select':
                            const seriesItem = series[newIndex];
                            openSeriesSelection(seriesItem);
                            break;
                    }

                    if (newIndex !== currentFocus.elementIndex) {
                        setFocus('series', newIndex, 'series');
                    }
                }

                // Handle movie navigation
                function handleMovieNavigation(direction) {
                    const itemsPerRow = Math.floor(moviesGrid.offsetWidth / 220); // Approximate items per row
                    const totalItems = moviesGrid.children.length;

                    let newIndex = currentFocus.elementIndex;

                    switch(direction) {
                        case 'up':
                            newIndex = Math.max(0, newIndex - itemsPerRow);
                            break;
                        case 'down':
                            newIndex = Math.min(totalItems - 1, newIndex + itemsPerRow);
                            break;
                        case 'left':
                            newIndex = Math.max(0, newIndex - 1);
                            break;
                        case 'right':
                            newIndex = Math.min(totalItems - 1, newIndex + 1);
                            break;
                        case 'select':
                            const movie = movies[newIndex];
                            playMovieFullscreen(movie);
                            break;
                    }

                    if (newIndex !== currentFocus.elementIndex) {
                        setFocus('movies', newIndex, 'movie');
                    }
                }

                // Handle nav navigation
                function handleNavNavigation(direction) {
                    let newIndex = currentFocus.elementIndex;

                    switch(direction) {
                        case 'up':
                            if (currentFocus.section === 'home') {
                                setFocus('home', 0, 'channel');
                            }
                            return;
                        case 'down':
                            // Already at bottom, do nothing
                            return;
                        case 'left':
                            newIndex = Math.max(0, newIndex - 1);
                            break;
                        case 'right':
                            newIndex = Math.min(navBtns.length - 1, newIndex + 1);
                            break;
                        case 'select':
                            const section = navBtns[newIndex].dataset.section;
                            showSection(section);
                            setActiveNav(navBtns[newIndex]);
                            
                            // Set focus to first item in the new section
                            if (section === 'home' || section === 'channels') {
                                setFocus(section, 0, 'channel');
                            } else if (section === 'series') {
                                setFocus('series', 0, 'series');
                            } else if (section === 'movies') {
                                setFocus('movies', 0, 'movie');
                            }
                            return;
                    }

                    if (newIndex !== currentFocus.elementIndex) {
                        setFocus(currentFocus.section, newIndex, 'nav');
                    }
                }

                // Handle episode navigation
                function handleEpisodeNavigation(direction) {
                    const itemsPerRow = Math.floor(episodesGrid.offsetWidth / 170); // Approximate items per row
                    const totalItems = episodesGrid.children.length;

                    let newIndex = currentFocus.elementIndex;

                    switch(direction) {
                        case 'up':
                            newIndex = Math.max(0, newIndex - itemsPerRow);
                            break;
                        case 'down':
                            newIndex = Math.min(totalItems - 1, newIndex + itemsPerRow);
                            break;
                        case 'left':
                            newIndex = Math.max(0, newIndex - 1);
                            break;
                        case 'right':
                            newIndex = Math.min(totalItems - 1, newIndex + 1);
                            break;
                        case 'select':
                            const episode = currentSeries.episodes[newIndex];
                            if (episode.videoUrl) {
                                playSeriesFullscreen(episode.videoUrl);
                                closeSeriesSelection();
                            }
                            break;
                        case 'back':
                            closeSeriesSelection();
                            setFocus('series', currentFocus.elementIndex, 'series');
                            break;
                    }

                    if (newIndex !== currentFocus.elementIndex) {
                        setFocus(currentFocus.section, newIndex, 'episode');
                    }
                }

                // Handle keyboard
                function handleKeyboard(e) {
                    if (isFullscreen || seriesFullscreenPlayer.classList.contains('active') || 
                        moviesFullscreenPlayer.classList.contains('active') || seriesSelectionModal.classList.contains('active')) {
                        // Navigation in fullscreen or modal modes
                        switch(e.key) {
                            case 'Escape':
                            case 'Backspace':
                                if (seriesFullscreenPlayer.classList.contains('active')) {
                                    exitSeriesFullscreen();
                                } else if (moviesFullscreenPlayer.classList.contains('active')) {
                                    exitMoviesFullscreen();
                                } else if (isFullscreen) {
                                    exitFullscreen();
                                } else if (seriesSelectionModal.classList.contains('active')) {
                                    closeSeriesSelection();
                                }
                                e.preventDefault();
                                break;
                            case 'ArrowLeft':
                                if (isFullscreen) changeChannel(-1);
                                else handleTVNavigation('left');
                                e.preventDefault();
                                break;
                            case 'ArrowRight':
                                if (isFullscreen) changeChannel(1);
                                else handleTVNavigation('right');
                                e.preventDefault();
                                break;
                            case 'ArrowUp':
                                handleTVNavigation('up');
                                e.preventDefault();
                                break;
                            case 'ArrowDown':
                                handleTVNavigation('down');
                                e.preventDefault();
                                break;
                            case 'Enter':
                            case ' ':
                                handleTVNavigation('select');
                                e.preventDefault();
                                break;
                            case '0':
                            case '1':
                            case '2':
                            case '3':
                            case '4':
                            case '5':
                            case '6':
                            case '7':
                            case '8':
                            case '9':
                                if (isFullscreen) {
                                    const channelNumber = parseInt(e.key);
                                    if (channelNumber <= channels.length) {
                                        changeToChannel(channelNumber - 1);
                                    }
                                }
                                e.preventDefault();
                                break;
                        }
                    } else {
                        // Navigation in main interface
                        switch(e.key) {
                            case 'ArrowLeft':
                                handleTVNavigation('left');
                                e.preventDefault();
                                break;
                            case 'ArrowRight':
                                handleTVNavigation('right');
                                e.preventDefault();
                                break;
                            case 'ArrowUp':
                                handleTVNavigation('up');
                                e.preventDefault();
                                break;
                            case 'ArrowDown':
                                handleTVNavigation('down');
                                e.preventDefault();
                                break;
                            case 'Enter':
                            case ' ':
                                handleTVNavigation('select');
                                e.preventDefault();
                                break;
                            case 'Escape':
                            case 'Backspace':
                                if (settingsModal.classList.contains('active')) {
                                    closeSettings();
                                }
                                e.preventDefault();
                                break;
                        }
                    }
                }

                // Cambiar canal (dirección: -1 para anterior, 1 para siguiente)
                function changeChannel(direction) {
                    currentChannelIndex += direction;
                    
                    if (currentChannelIndex < 0) {
                        currentChannelIndex = channels.length - 1;
                    } else if (currentChannelIndex >= channels.length) {
                        currentChannelIndex = 0;
                    }
                    
                    playChannelFullscreen(channels[currentChannelIndex]);
                    showChannelChangeNotification(channels[currentChannelIndex].title);
                }

                // Cambiar a canal específico
                function changeToChannel(index) {
                    if (index >= 0 && index < channels.length) {
                        currentChannelIndex = index;
                        playChannelFullscreen(channels[currentChannelIndex]);
                        showChannelChangeNotification(channels[currentChannelIndex].title);
                    }
                }

                // Mostrar notificación de cambio de canal
                function showChannelChangeNotification(channelName) {
                    const existingNotification = document.querySelector('.channel-change-notification');
                    if (existingNotification) {
                        existingNotification.remove();
                    }
                    
                    const notification = document.createElement('div');
                    notification.className = 'channel-change-notification';
                    notification.innerHTML = `
                        <div class="notification-content">
                            <span class="channel-number">${currentChannelIndex + 1}</span>
                            <span class="channel-name">${channelName}</span>
                        </div>
                    `;
                    
                    document.body.appendChild(notification);
                    
                    setTimeout(() => {
                        notification.style.opacity = '0';
                        setTimeout(() => {
                            if (notification.parentNode) {
                                notification.remove();
                            }
                        }, 300);
                    }, 2000);
                }

                // Setup auto fullscreen functionality
                function setupAutoFullscreen() {
                    const observer = new MutationObserver(function(mutations) {
                        mutations.forEach(function(mutation) {
                            if (mutation.type === 'childList' && fullscreenIframeContainer.children.length > 0) {
                                enterFullscreen();
                            }
                        });
                    });
                    
                    observer.observe(fullscreenIframeContainer, { childList: true });
                }

                // Enter fullscreen mode
                function enterFullscreen() {
                    removeSnowflakes(); // Remove snowflakes in fullscreen
                    fullscreenPlayer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    isFullscreen = true;
                    currentChannelIndex = channels.findIndex(ch => ch.id === currentChannel.id);
                    
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                        });
                    }
                    
                    addTVControls();
                }

                // Agregar controles de TV en pantalla completa
                function addTVControls() {
                    const existingControls = document.querySelector('.tv-controls-overlay');
                    if (existingControls) {
                        existingControls.remove();
                    }
                    
                    const controls = document.createElement('div');
                    controls.className = 'tv-controls-overlay';
                    controls.innerHTML = `
                        <div class="tv-controls-info">
                            <div class="current-channel">${currentChannel.title}</div>
                            <div class="tv-instructions">
                                ← → Cambiar canal | ESC Salir | 1-${channels.length} Canal directo
                            </div>
                        </div>
                    `;
                    
                    fullscreenPlayer.appendChild(controls);
                    
                    setTimeout(() => {
                        controls.style.opacity = '0';
                    }, 5000);
                    
                    fullscreenPlayer.addEventListener('mousemove', showTVControls);
                    
                    function showTVControls() {
                        controls.style.opacity = '1';
                        setTimeout(() => {
                            controls.style.opacity = '0';
                        }, 5000);
                    }
                }

                // Exit fullscreen mode
                function exitFullscreen() {
                    restoreSnowflakes(); // Restore snowflakes when exiting fullscreen
                    fullscreenPlayer.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    isFullscreen = false;
                    
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    }
                    
                    fullscreenIframeContainer.innerHTML = '';
                    
                    const controls = document.querySelector('.tv-controls-overlay');
                    if (controls) {
                        controls.remove();
                    }
                    
                    fullscreenPlayer.removeEventListener('mousemove', showTVControls);
                    
                    // Restore focus to the channel that was playing
                    const channelIndex = channels.findIndex(ch => ch.id === currentChannel.id);
                    setFocus(currentFocus.section, channelIndex, 'channel');
                }

                // Open settings modal
                function openSettings() {
                    settingsModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                }

                // Close settings modal
                function closeSettings() {
                    settingsModal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                }

                // Show selected section
                function showSection(sectionId) {
                    contentSections.forEach(section => {
                        section.classList.remove('active');
                    });
                    
                    document.getElementById(`tv-${sectionId}-section`).classList.add('active');
                }

                // Set active nav
                function setActiveNav(activeItem) {
                    navBtns.forEach(btn => {
                        btn.classList.remove('active');
                    });
                    
                    activeItem.classList.add('active');
                }

                // Render channels to the grids
                function renderChannels() {
                    channelsGrid.innerHTML = '';
                    allChannelsGrid.innerHTML = '';
                    
                    channels.forEach((channel, index) => {
                        const channelCard = createChannelCard(channel, index);
                        channelsGrid.appendChild(channelCard);
                        
                        const fullChannelCard = createChannelCard(channel, index);
                        allChannelsGrid.appendChild(fullChannelCard);
                    });
                }

                // Create channel card element
                function createChannelCard(channel, index) {
                    const card = document.createElement('div');
                    card.className = 'channel-card';
                    card.dataset.id = channel.id;
                    
                    card.innerHTML = `
                        <div class="channel-thumbnail">
                            <img src="${channel.thumbnail}" alt="${channel.title}" loading="lazy">
                            <span class="channel-live-badge">EN VIVO</span>
                            <span class="channel-number">${index + 1}</span>
                        </div>
                        <div class="channel-title">${channel.title}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        playChannelFullscreen(channel);
                    });
                    
                    return card;
                }

                // Play channel in fullscreen
                function playChannelFullscreen(channel) {
                    currentChannel = channel;
                    currentChannelIndex = channels.findIndex(ch => ch.id === channel.id);
                    fullscreenIframeContainer.innerHTML = channel.iframeCode;
                }

                // Render series to the grid
                function renderSeries() {
                    seriesGrid.innerHTML = '';
                    
                    series.forEach((serie, index) => {
                        const seriesCard = createSeriesCard(serie, index);
                        seriesGrid.appendChild(seriesCard);
                    });
                }

                // Create series card element
                function createSeriesCard(serie, index) {
                    const card = document.createElement('div');
                    card.className = 'series-card';
                    card.dataset.id = serie.id;
                    
                    card.innerHTML = `
                        <div class="series-thumbnail">
                            <img src="${serie.thumbnail}" alt="${serie.title}" loading="lazy">
                        </div>
                        <div class="series-title">${serie.title}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        openSeriesSelection(serie);
                    });
                    
                    return card;
                }

                // Render movies to the grid
                function renderMovies() {
                    moviesGrid.innerHTML = '';
                    
                    movies.forEach((movie, index) => {
                        const movieCard = createMovieCard(movie, index);
                        moviesGrid.appendChild(movieCard);
                    });
                }

                // Create movie card element
                function createMovieCard(movie, index) {
                    const card = document.createElement('div');
                    card.className = 'movie-card';
                    card.dataset.id = movie.id;
                    
                    card.innerHTML = `
                        <div class="movie-thumbnail">
                            <img src="${movie.thumbnail}" alt="${movie.title}" loading="lazy">
                        </div>
                        <div class="movie-title">${movie.title}</div>
                    `;
                    
                    card.addEventListener('click', function() {
                        playMovieFullscreen(movie);
                    });
                    
                    return card;
                }

                // Open series selection modal
                function openSeriesSelection(serie) {
                    currentSeries = serie;
                    seriesModalTitle.textContent = serie.title;
                    episodesGrid.innerHTML = '';
                    
                    serie.episodes.forEach((episode, index) => {
                        const episodeCard = createEpisodeCard(episode, index);
                        episodesGrid.appendChild(episodeCard);
                    });
                    
                    seriesSelectionModal.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Set focus to first episode
                    setFocus('series-modal', 0, 'episode');
                }

                // Create episode card element - AHORA INCLUYE NÚMERO DE EPISODIO SIEMPRE VISIBLE
                function createEpisodeCard(episode, index) {
                    const card = document.createElement('div');
                    card.className = 'episode-card';
                    card.dataset.id = episode.id;
                    
                    card.innerHTML = `
                        <div class="episode-thumbnail">
                            <img src="${episode.thumbnail}" alt="${episode.title}" loading="lazy">
                            <div class="episode-number-badge">${index + 1}</div>
                        </div>
                        <div class="episode-info">
                            <div class="episode-title">${episode.title}</div>
                            <div class="episode-duration">${episode.duration}</div>
                        </div>
                    `;
                    
                    card.addEventListener('click', function() {
                        if (episode.videoUrl) {
                            playSeriesFullscreen(episode.videoUrl);
                            closeSeriesSelection();
                        }
                    });
                    
                    return card;
                }

                // Close series selection modal
                function closeSeriesSelection() {
                    seriesSelectionModal.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    
                    // Restore focus to the series that was selected
                    const seriesIndex = series.findIndex(s => s.id === currentSeries.id);
                    setFocus('series', seriesIndex, 'series');
                }

                // Play series in fullscreen
                function playSeriesFullscreen(videoUrl) {
                    removeSnowflakes(); // Remove snowflakes in fullscreen
                    seriesIframe.src = videoUrl;
                    seriesFullscreenPlayer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Entrar automáticamente en pantalla completa
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                        });
                    }
                    
                    // Forzar el sonido (esto depende de las políticas del navegador)
                    setTimeout(() => {
                        try {
                            seriesIframe.contentWindow.postMessage('{"func":"playVideo"}', '*');
                        } catch(e) {
                            console.log('No se pudo forzar reproducción automática');
                        }
                    }, 1000);
                }

                // Play movie in fullscreen
                function playMovieFullscreen(movie) {
                    removeSnowflakes(); // Remove snowflakes in fullscreen
                    moviesIframe.src = movie.videoUrl;
                    moviesFullscreenPlayer.classList.add('active');
                    document.body.style.overflow = 'hidden';
                    
                    // Entrar automáticamente en pantalla completa
                    if (!document.fullscreenElement) {
                        document.documentElement.requestFullscreen().catch(err => {
                            console.log('Fullscreen error:', err);
                        });
                    }
                    
                    // Forzar el sonido (esto depende de las políticas del navegador)
                    setTimeout(() => {
                        try {
                            moviesIframe.contentWindow.postMessage('{"func":"playVideo"}', '*');
                        } catch(e) {
                            console.log('No se pudo forzar reproducción automática');
                        }
                    }, 1000);
                }

                // Exit series fullscreen
                function exitSeriesFullscreen() {
                    restoreSnowflakes(); // Restore snowflakes when exiting fullscreen
                    seriesFullscreenPlayer.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    seriesIframe.src = '';
                    
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    }
                }

                // Exit movies fullscreen
                function exitMoviesFullscreen() {
                    restoreSnowflakes(); // Restore snowflakes when exiting fullscreen
                    moviesFullscreenPlayer.classList.remove('active');
                    document.body.style.overflow = 'auto';
                    moviesIframe.src = '';
                    
                    if (document.fullscreenElement) {
                        document.exitFullscreen();
                    }
                }

                // Initialize the TV app
                setupEventListeners();
                renderChannels();
                renderSeries();
                renderMovies();
                showSection('home');
                setupAutoFullscreen();
                setupTVNavigation();
            }
        });
    </script>
</body>
</html>








